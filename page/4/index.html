<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="学习总结 思想感悟">
<meta property="og:type" content="website">
<meta property="og:title" content="Skye&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Skye&#39;s Blog">
<meta property="og:description" content="学习总结 思想感悟">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Skye&#39;s Blog">
<meta name="twitter:description" content="学习总结 思想感悟">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/4/"/>





  <title>Skye's Blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0ad3004c649d5e3dfe7d01df4a20ad3f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Skye's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Forever youthful,forever weeping</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/03/mapreduce执行错误Mapper.init错误/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/03/mapreduce执行错误Mapper.init错误/" itemprop="url">mapreduce执行错误Mapper.<init>错误</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-03T20:07:23+08:00">
                2016-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/11/03/mapreduce执行错误Mapper.init错误/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/03/mapreduce执行错误Mapper.init错误/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>参考<br><a href="http://blog.itpub.net/30066956/viewspace-2107549/" target="_blank" rel="external">http://blog.itpub.net/30066956/viewspace-2107549/</a></p>
</blockquote>
<p>错误详情：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">16/11/02 21:37:26 INFO mapreduce.Job: Task Id : attempt_1476760655616_0574_m_000027_2, Status : FAILED</div><div class="line">Error: java.lang.RuntimeException: java.lang.NoSuchMethodException: com.hdu.recommend.tools.CopyData$QLMapper.&lt;init&gt;()</div><div class="line">	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:131)</div><div class="line">	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:742)</div><div class="line">	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:341)</div><div class="line">	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:168)</div><div class="line">	at java.security.AccessController.doPrivileged(Native Method)</div><div class="line">	at javax.security.auth.Subject.doAs(Subject.java:415)</div><div class="line">	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1614)</div><div class="line">	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:163)</div><div class="line">Caused by: java.lang.NoSuchMethodException: com.hdu.recommend.tools.CopyData$QLMapper.&lt;init&gt;()</div><div class="line">	at java.lang.Class.getConstructor0(Class.java:2849)</div><div class="line">	at java.lang.Class.getDeclaredConstructor(Class.java:2053)</div><div class="line">	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:125)</div><div class="line">	... 7 more</div></pre></td></tr></table></figure></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/11/03/mapreduce执行错误Mapper.init错误/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/" itemprop="url">eclipse中操作hive错误org.apache.hadoop.security.AccessControlException</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-03T19:27:08+08:00">
                2016-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">java.sql.SQLException: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask</div><div class="line"></div><div class="line">Job Submission failed with exception &apos;org.apache.hadoop.security.AccessControlException(Permission denied: user=anonymous, access=WRITE, inode=&quot;/user&quot;:hdfs:supergroup:drwxr-xr-x</div></pre></td></tr></table></figure></p>
<p>解决：<br>权限问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop fs -chmod -R 777  /</div></pre></td></tr></table></figure></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/28/Git SSH公钥配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/28/Git SSH公钥配置/" itemprop="url">Git SSH公钥配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-28T16:28:47+08:00">
                2016-10-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/28/Git SSH公钥配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/28/Git SSH公钥配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>Coding.net配置</p>
</blockquote>
<h3 id="账户-SSH-公钥"><a href="#账户-SSH-公钥" class="headerlink" title="账户 SSH 公钥"></a>账户 SSH 公钥</h3><p>账户 SSH 公钥是跟用户账户关联的公钥，一旦设置，SSH 就拥有账户下所有项目仓库的读写权限。 设置“账户 SSH 公钥”是开发者使用 SSH 方式访问/修改代码仓库的“前置工作”，分为“获取 SSH 协议地址”、“生成公钥”、“在 Coding.net 添加公钥”三个步骤。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/10/28/Git SSH公钥配置/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/27/spark-1.6.0安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/27/spark-1.6.0安装/" itemprop="url">spark-1.6.0安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-27T12:52:59+08:00">
                2016-10-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/27/spark-1.6.0安装/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/27/spark-1.6.0安装/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>已安装Hadoop2.7.2的三节点集群</p>
</blockquote>
<h3 id="安装Scala"><a href="#安装Scala" class="headerlink" title="安装Scala"></a>安装Scala</h3><ol>
<li>下载scala-2.11.7.tgz</li>
<li><p>解压Scala</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ tar -zxvf scala-2.11.7.tgz -C ~/cloud/</div></pre></td></tr></table></figure>
</li>
<li><p>配置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">export  SCALA_HOME=/home/ubuntu/cloud/scala-2.11.7</div><div class="line">export PATH = $PATH:$SCALA_HOME/bin</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scala -version</div><div class="line">Scala code runner version 2.11.7 -- Copyright 2002-2013, LAMP/EPFL</div></pre></td></tr></table></figure>
</li>
<li><p>配置到每台节点</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/10/27/spark-1.6.0安装/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/18/name node is in safe mode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/18/name node is in safe mode/" itemprop="url">name node is in safe mode问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-18T21:56:09+08:00">
                2016-10-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/18/name node is in safe mode/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/18/name node is in safe mode/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="name-node-is-in-safe-mode"><a href="#name-node-is-in-safe-mode" class="headerlink" title="name node is in safe mode"></a>name node is in safe mode</h3><p>问题： 向hdfs put数据的时候，导致了 name node is in safe mode，然后使用 Hadoop dfsadmin -safemode leave 后， 解除了安全模式。可是再次使用hdfs put或rm数据，仍旧导致name node 进入安全模式。</p>
<p>答案：分析了一下，问题是namenode所在机器的硬盘满了。因此即使使用了 hadoop dfsadmin -safemode leave 之后， 仍旧不能使用hdfs。</p>
<h4 id="解决办法："><a href="#解决办法：" class="headerlink" title="解决办法："></a>解决办法：</h4><ol>
<li>删除namenode所在机器的一些数据（本地数据）</li>
<li>结束安全模式   hadoop dfsadmin -safemode leave </li>
<li>可以正常使用hdfs了</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/18/LinkedHashMap和TreeMap的区别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/18/LinkedHashMap和TreeMap的区别/" itemprop="url">LinkedHashMap和TreeMap的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-18T21:53:44+08:00">
                2016-10-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/18/LinkedHashMap和TreeMap的区别/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/18/LinkedHashMap和TreeMap的区别/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="LinkedHashMap和TreeMap的区别"><a href="#LinkedHashMap和TreeMap的区别" class="headerlink" title="LinkedHashMap和TreeMap的区别"></a>LinkedHashMap和TreeMap的区别</h3><p>首先2个都是map，所以用key取值肯定是没区别的，区别在于用Iterator遍历的时候<br>LinkedHashMap保存了记录的插入顺序，先插入的先遍历到<br>TreeMap默认是按升序排，也可以指定排序的比较器。遍历的时候按升序遍历。<br>例如：a是LinkedHashMap，b是TreeMap。<br>a.put(“2”,”ab”);<br>a.put(“1”,”bc”);<br>b.put(“2”,”ab”);<br>b.put(“1”,”bc”);</p>
<p>那么遍历a的时候，先遍历到key是2的，因为2先放进去。<br>遍历b的时候，先遍历到“1”，因为按顺序是先1后2</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/21/HDUACM1200/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/21/HDUACM1200/" itemprop="url">HDUACM1200</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-21T15:00:56+08:00">
                2016-09-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ACM/" itemprop="url" rel="index">
                    <span itemprop="name">ACM</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/09/21/HDUACM1200/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/21/HDUACM1200/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">To and Fro</div><div class="line"></div><div class="line">Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 65536/32768 K (Java/Others)</div><div class="line">Total Submission(s): 6390    Accepted Submission(s): 4389</div><div class="line"></div><div class="line"></div><div class="line">Problem Description</div><div class="line">Mo and Larry have devised a way of encrypting messages. They first decide secretly on the number of columns and write the message (letters only) down the columns, padding with extra random letters so as to make a rectangular array of letters. For example, if the message is “There’s no place like home on a snowy night” and there are five columns, Mo would write down</div><div class="line"></div><div class="line">t o i o y</div><div class="line">h p k n n</div><div class="line">e l e a i</div><div class="line">r a h s g</div><div class="line">e c o n h</div><div class="line">s e m o t</div><div class="line">n l e w x</div><div class="line"></div><div class="line"></div><div class="line">Note that Mo includes only letters and writes them all in lower case. In this example, Mo used the character ‘x’ to pad the message out to make a rectangle, although he could have used any letter.</div><div class="line"></div><div class="line">Mo then sends the message to Larry by writing the letters in each row, alternating left-to-right and right-to-left. So, the above would be encrypted as</div><div class="line"></div><div class="line">toioynnkpheleaigshareconhtomesnlewx</div><div class="line"></div><div class="line">Your job is to recover for Larry the original message (along with any extra padding letters) from the encrypted one.</div><div class="line"> </div><div class="line"></div><div class="line">Input</div><div class="line">There will be multiple input sets. Input for each set will consist of two lines. The first line will contain an integer in the range 2. . . 20 indicating the number of columns used. The next line is a string of up to 200 lower case letters. The last input set is followed by a line containing a single 0, indicating end of input.</div><div class="line"> </div><div class="line"></div><div class="line">Output</div><div class="line">Each input set should generate one line of output, giving the original plaintext message, with no spaces.</div><div class="line"> </div><div class="line"></div><div class="line">Sample Input</div><div class="line">5</div><div class="line">toioynnkpheleaigshareconhtomesnlewx</div><div class="line">3</div><div class="line">ttyohhieneesiaabss</div><div class="line">0</div><div class="line"> </div><div class="line"></div><div class="line">Sample Output</div><div class="line">theresnoplacelikehomeonasnowynightx</div><div class="line">thisistheeasyoneab</div><div class="line"> </div><div class="line"></div><div class="line">Source</div><div class="line">East Central North America 2004</div><div class="line"> </div><div class="line"></div><div class="line">Recommend</div><div class="line">Ignatius.L   |   We have carefully selected several similar problems for you:  1196 1073 1161 1113 1256</div></pre></td></tr></table></figure>
<h3 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line">package hdu;</div><div class="line"></div><div class="line">import java.util.Scanner;</div><div class="line">/**</div><div class="line"> * 做的时候没看清楚  直接把蛇形输出做了正序的转换，然后才进行二维数组存储，多了个步骤</div><div class="line"> * @author Skye</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class Main &#123;</div><div class="line"></div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		// TODO Auto-generated method stub</div><div class="line"></div><div class="line">		Scanner sc = new Scanner(System.in);</div><div class="line">		int col = sc.nextInt();</div><div class="line">		String message = null;</div><div class="line">		int rowNum,row = 0;</div><div class="line">		StringBuffer result = new StringBuffer();</div><div class="line">		char[] stringArr = null;</div><div class="line">		StringBuffer tmpString = new StringBuffer();</div><div class="line">		char[] tmpChar = null;</div><div class="line">		boolean isChange = false;</div><div class="line">		while (col != 0) &#123;</div><div class="line">			message = sc.next();</div><div class="line">			rowNum = message.length()/col;</div><div class="line">			// System.out.println(message);</div><div class="line">			stringArr = message.toCharArray();</div><div class="line">			// ttyohhieneesiaabss</div><div class="line">			for (int i = 0; i &lt; stringArr.length; i++) &#123;</div><div class="line">				// System.out.println(stringArr[i]);</div><div class="line">				if (i % col == 0) &#123; // 到行开头</div><div class="line">					row = i / col + 1; // 记录当前字母在第几行</div><div class="line">					if (row % 2 == 0) &#123;</div><div class="line">						isChange = true;</div><div class="line">					&#125; else &#123;</div><div class="line">						isChange = false;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if (isChange == false) &#123;</div><div class="line">					</div><div class="line">					if (i != 0 &amp;&amp; i % col == 0) &#123;</div><div class="line">						//System.out.println(tmpString.toString());</div><div class="line">						tmpChar = tmpString.toString().toCharArray();</div><div class="line">						for (int j = tmpChar.length - 1; j &gt;= 0; j--) &#123;</div><div class="line">							result.append(tmpChar[j]);</div><div class="line">						&#125;</div><div class="line">						tmpString = new StringBuffer();</div><div class="line">					&#125;</div><div class="line">					result.append(stringArr[i]);</div><div class="line">				&#125; else &#123;</div><div class="line">					tmpString.append(stringArr[i]);</div><div class="line">				&#125;</div><div class="line"></div><div class="line">			&#125;</div><div class="line">			if(isChange == true)&#123;</div><div class="line">				//System.out.println(tmpString.toString());</div><div class="line">				tmpChar = tmpString.toString().toCharArray();</div><div class="line">				for (int j = tmpChar.length - 1; j &gt;= 0; j--) &#123;</div><div class="line">					result.append(tmpChar[j]);</div><div class="line">				&#125;</div><div class="line">				tmpString = new StringBuffer();</div><div class="line">			&#125;</div><div class="line">			//System.out.println(result);</div><div class="line">			</div><div class="line">			char[][] charArr = new char[rowNum][col];</div><div class="line">			char[] resultChar = result.toString().toCharArray();</div><div class="line">			int count = 0;</div><div class="line">			for(int k = 0; k &lt; rowNum;k++)&#123;</div><div class="line">				for(int p = 0; p &lt; col;p++)&#123;</div><div class="line">					charArr[k][p] = resultChar[count++];</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			StringBuffer resultFinal = new StringBuffer();</div><div class="line">			for(int k = 0; k &lt; col;k++)&#123;</div><div class="line">				for(int p = 0; p &lt; rowNum;p++)&#123;</div><div class="line">					resultFinal.append(charArr[p][k]);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			System.out.println(resultFinal);</div><div class="line">			resultFinal = new StringBuffer();</div><div class="line">			result = new StringBuffer();</div><div class="line">			col = sc.nextInt();</div><div class="line">		&#125;</div><div class="line">		sc.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="HDU另解："><a href="#HDU另解：" class="headerlink" title="HDU另解："></a>HDU另解：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">import java.io.*;</div><div class="line">import java.util.*;</div><div class="line"></div><div class="line">public class Main</div><div class="line">&#123;</div><div class="line"></div><div class="line">	public static void main(String[] args)</div><div class="line">	&#123;</div><div class="line">		Scanner input = new Scanner(System.in);</div><div class="line">		while (input.hasNext())</div><div class="line">		&#123;</div><div class="line">			int n = input.nextInt();</div><div class="line">			if(n==0) break;</div><div class="line">			input.nextLine();</div><div class="line">			String str = input.nextLine();</div><div class="line">			char c1[] = str.toCharArray();                   // 把每个字符单个存起来</div><div class="line">			char c2[][] = new char[1010][1010];</div><div class="line">			int line = c1.length / n;                        //记录行数</div><div class="line">			int k = 0;                                      // 记录c1字符的位数</div><div class="line">			for (int i = 0; i &lt; line; i++)</div><div class="line">			&#123;</div><div class="line">				if (i % 2 == 1)</div><div class="line">				&#123;</div><div class="line">					for (int j = n - 1; j &gt;= 0; j--)</div><div class="line">					&#123;</div><div class="line">						c2[i][j] = c1[k++];</div><div class="line">					&#125;</div><div class="line">				&#125; </div><div class="line">				else</div><div class="line">				&#123;</div><div class="line">					for (int j = 0; j &lt; n; j++)</div><div class="line">					&#123;</div><div class="line">						c2[i][j] = c1[k++];</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			for (int j = 0; j &lt; n; j++)</div><div class="line">			&#123;</div><div class="line">				for (int i = 0; i &lt; line; i++)</div><div class="line">				&#123;</div><div class="line">					System.out.print(c2[i][j]);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			System.out.println();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/31/Java Map 按key排序和按Value排序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/31/Java Map 按key排序和按Value排序/" itemprop="url">Java Map 按key排序和按Value排序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-31T15:24:13+08:00">
                2016-08-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/31/Java Map 按key排序和按Value排序/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/31/Java Map 按key排序和按Value排序/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>做推荐系统项目时，对标签评分需要对标签评分map进行排序.</p>
<h3 id="理论准备"><a href="#理论准备" class="headerlink" title="理论准备"></a>理论准备</h3><ul>
<li><p>Map是键值对的集合接口，它的实现类主要包括：HashMap,TreeMap,Hashtable以及LinkedHashMap等。</p>
</li>
<li><p>TreeMap：基于红黑树（Red-Black tree）的 NavigableMap 实现，该映射根据其键的自然顺序进行排序，或者根据创建映射时提供的 Comparator 进行排序，具体取决于使用的构造方法。<br>HashMap的值是没有顺序的，它是按照key的HashCode来实现的，对于这个无序的HashMap我们要怎么来实现排序呢？参照TreeMap的value排序。</p>
</li>
<li><p>Map.Entry返回Collections视图。</p>
</li>
</ul>
<h3 id="key排序"><a href="#key排序" class="headerlink" title="key排序"></a>key排序</h3><p>TreeMap默认是升序的，如果我们需要改变排序方式，则需要使用比较器：Comparator。Comparator可以对集合对象或者数组进行排序的比较器接口，实现该接口的public compare(T o1,To2)方法即可实现排序，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">import java.util.Comparator;</div><div class="line">import java.util.Iterator;</div><div class="line">import java.util.Map;</div><div class="line">import java.util.Set;</div><div class="line">import java.util.TreeMap;</div><div class="line">public class TreeMapTest &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        Map&lt;String, String&gt; map = new TreeMap&lt;String, String&gt;(</div><div class="line">                new Comparator&lt;String&gt;() &#123;</div><div class="line">                    public int compare(String obj1, String obj2) &#123;</div><div class="line">                        // 降序排序</div><div class="line">                        return obj2.compareTo(obj1);</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">        map.put(&quot;b&quot;, &quot;ccccc&quot;);</div><div class="line">        map.put(&quot;d&quot;, &quot;aaaaa&quot;);</div><div class="line">        map.put(&quot;c&quot;, &quot;bbbbb&quot;);</div><div class="line">        map.put(&quot;a&quot;, &quot;ddddd&quot;);</div><div class="line">        </div><div class="line">        Set&lt;String&gt; keySet = map.keySet();</div><div class="line">        Iterator&lt;String&gt; iter = keySet.iterator();</div><div class="line">        while (iter.hasNext()) &#123;</div><div class="line">            String key = iter.next();</div><div class="line">            System.out.println(key + &quot;:&quot; + map.get(key));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">d:aaaaa</div><div class="line">c:bbbbb</div><div class="line">b:ccccc</div><div class="line">a:ddddd</div></pre></td></tr></table></figure></p>
<h3 id="value排序"><a href="#value排序" class="headerlink" title="value排序"></a>value排序</h3><p>上面例子是对根据TreeMap的key值来进行排序的，但是有时我们需要根据TreeMap的value来进行排序。对value排序我们就需要借助于Collections的sort(List<t> list, Comparator&lt;? super T&gt; c)方法，该方法根据指定比较器产生的顺序对指定列表进行排序。但是有一个前提条件，那就是所有的元素都必须能够根据所提供的比较器来进行比较，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.Collections;</div><div class="line">import java.util.Comparator;</div><div class="line">import java.util.List;</div><div class="line">import java.util.Map;</div><div class="line">import java.util.Map.Entry;</div><div class="line">import java.util.TreeMap;</div><div class="line">public class TreeMapTest &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        Map&lt;String, String&gt; map = new TreeMap&lt;String, String&gt;();</div><div class="line">        map.put(&quot;a&quot;, &quot;ddddd&quot;);</div><div class="line">        map.put(&quot;c&quot;, &quot;bbbbb&quot;);</div><div class="line">        map.put(&quot;d&quot;, &quot;aaaaa&quot;);</div><div class="line">        map.put(&quot;b&quot;, &quot;ccccc&quot;);</div><div class="line">        </div><div class="line">        //这里将map.entrySet()转换成list</div><div class="line">        List&lt;Map.Entry&lt;String,String&gt;&gt; list = new ArrayList&lt;Map.Entry&lt;String,String&gt;&gt;(map.entrySet());</div><div class="line">        //然后通过比较器来实现排序</div><div class="line">        Collections.sort(list,new Comparator&lt;Map.Entry&lt;String,String&gt;&gt;() &#123;</div><div class="line">            //升序排序</div><div class="line">            public int compare(Entry&lt;String, String&gt; o1,</div><div class="line">                    Entry&lt;String, String&gt; o2) &#123;</div><div class="line">                return o1.getValue().compareTo(o2.getValue());</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">        &#125;);</div><div class="line">        </div><div class="line">        for(Map.Entry&lt;String,String&gt; mapping:list)&#123; </div><div class="line">               System.out.println(mapping.getKey()+&quot;:&quot;+mapping.getValue()); </div><div class="line">          &#125; </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></t></p>
<p>运行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">d:aaaaa</div><div class="line">c:bbbbb</div><div class="line">b:ccccc</div><div class="line">a:ddddd</div></pre></td></tr></table></figure></p>
<blockquote>
<p>参考：<a href="http://blog.csdn.net/xiaoyu714543065/article/details/38519817" target="_blank" rel="external">http://blog.csdn.net/xiaoyu714543065/article/details/38519817</a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/29/Java BufferdReader读取文件乱码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/29/Java BufferdReader读取文件乱码/" itemprop="url">Java BufferdReader读取文件乱码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-29T21:23:57+08:00">
                2016-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/29/Java BufferdReader读取文件乱码/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/29/Java BufferdReader读取文件乱码/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="javaBufferdReader读取文件乱码"><a href="#javaBufferdReader读取文件乱码" class="headerlink" title="javaBufferdReader读取文件乱码"></a>javaBufferdReader读取文件乱码</h3><p>以下为读取文件方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">private static void putIdGame()&#123;</div><div class="line">	</div><div class="line">	URL.setURLStreamHandlerFactory(new FsUrlStreamHandlerFactory());</div><div class="line">	int count = 0;</div><div class="line">	try &#123;</div><div class="line"></div><div class="line">		</div><div class="line">		URL url = new URL(HDFS + path);</div><div class="line">		InputStream gameList = url.openStream();</div><div class="line">		BufferedReader reader_url = new BufferedReader(new InputStreamReader(gameList,&quot;UTF-8&quot;));</div><div class="line">		String inString_RL = reader_url.readLine();</div><div class="line">		</div><div class="line">		while (inString_RL != null &amp;&amp; count &lt; 50) &#123;</div><div class="line">			int userId;</div><div class="line">			String[] str = inString_RL.split(&quot;,&quot;); </div><div class="line">			count ++;</div><div class="line">			map.put(str[1], str[0]);</div><div class="line">			System.out.println(str[0]);</div><div class="line">			inString_RL = reader_url.readLine();</div><div class="line">		&#125;</div><div class="line">		reader_url.close();</div><div class="line">	&#125; catch (FileNotFoundException e) &#123;</div><div class="line">		System.out.println(&quot;未找文件！&quot;);</div><div class="line">	&#125; catch (IOException e1) &#123;</div><div class="line">		System.out.println(&quot;文件读写错误！&quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在<code>InputStreamReader</code>中加入”UTF-8”即可</p>
<h3 id="Java读取文件时第一行出现乱码“？”问号"><a href="#Java读取文件时第一行出现乱码“？”问号" class="headerlink" title="Java读取文件时第一行出现乱码“？”问号"></a>Java读取文件时第一行出现乱码“？”问号</h3><p>在windows 环境下，使用java文件流读取文本文件时，会出现第一个字符为未知字符”?” ,其他字符完整。而且第一个字符显示为？但是用equals比对发现并非是”?”号,google之，了解到bom编码标记。使用 16进制打印输出结果：</p>
<p>只要出现该头的16进制编码为这种字符便可以断定该文本文件的编码方式了。</p>
<p>bom编码标记：</p>
<p>bom全称是：byte order mark，汉语意思是标记字节顺序码。只是出现在：unicode字符集中，只有unicode字符集，存储时候，要求指定编码，如果不指定，windows还会用默认的：ANSI读取。常见的bom头是：</p>
<p>  UTF-8 ║ EF BB BF<br>  UTF-16LE ║ FF FE (小尾）<br>  UTF-16BE ║ FE FF （大尾）<br>  UTF-32LE ║ FF FE 00 00<br>  UTF-32BE ║ 00 00 FE FF</p>
<h4 id="解决方法："><a href="#解决方法：" class="headerlink" title="解决方法："></a>解决方法：</h4><ol>
<li><p>工具将txt文件另存为UTF-8无BOM格式</p>
</li>
<li></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public String readerFile(InputStream in) throws IOException &#123;</div><div class="line">		StringBuffer strBuff = new StringBuffer();</div><div class="line">		String temp = null;</div><div class="line">		BufferedReader reader = new BufferedReader(new InputStreamReader(in,Charset.forName(&quot;utf-8&quot;)));</div><div class="line">		while ((temp = reader.readLine()) != null) &#123;</div><div class="line">			byte[] by = temp.getBytes();</div><div class="line">			String header = Integer.toHexString(by[0]).toUpperCase();</div><div class="line">			//判断是否拥有无法识别的字符</div><div class="line">			if (header.equalsIgnoreCase(&quot;FFFFFFEF&quot;) || header.equalsIgnoreCase(&quot;3F&quot;)) &#123;</div><div class="line">				strBuff.append(temp.substring(1) + &quot;\n&quot;);</div><div class="line">				continue;</div><div class="line">			&#125;</div><div class="line">			strBuff.append(temp + &quot;\n&quot;);</div><div class="line">		&#125;</div><div class="line">		reader.close();</div><div class="line">		in.close();</div><div class="line">		return strBuff.toString();</div><div class="line">	&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/26/HDFS工具类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Skye">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Skye's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/26/HDFS工具类/" itemprop="url">HDFS工具类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-26T23:51:58+08:00">
                2016-08-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/26/HDFS工具类/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/26/HDFS工具类/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>花了点时间整理了验证一下在本地eclipse上操作HDFS的工具类，实现在本地通过API操作HDFS。</p>
<p>实现以下功能：</p>
<ul>
<li>ls </li>
<li>rmr</li>
<li>mkdir</li>
<li>copyFromLocal</li>
<li>cat</li>
<li>copyToLocal</li>
<li>创建一个新文件，并写入内容</li>
</ul>
<p>主要引用参考：</p>
<blockquote>
<p><a href="http://blog.fens.me/hadoop-hdfs-api/" target="_blank" rel="external">http://blog.fens.me/hadoop-hdfs-api/</a></p>
</blockquote>
<p>类如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div></pre></td><td class="code"><pre><div class="line">package com.hdu.hdfs;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.net.URI;</div><div class="line"></div><div class="line">import org.apache.hadoop.conf.Configuration;</div><div class="line">import org.apache.hadoop.fs.BlockLocation;</div><div class="line">import org.apache.hadoop.fs.FSDataInputStream;</div><div class="line">import org.apache.hadoop.fs.FSDataOutputStream;</div><div class="line">import org.apache.hadoop.fs.FileStatus;</div><div class="line">import org.apache.hadoop.fs.FileSystem;</div><div class="line">import org.apache.hadoop.fs.Hdfs;</div><div class="line">import org.apache.hadoop.fs.Path;</div><div class="line">import org.apache.hadoop.hdfs.web.HsftpFileSystem;</div><div class="line">import org.apache.hadoop.io.IOUtils;</div><div class="line">import org.apache.hadoop.mapred.JobConf;</div><div class="line"></div><div class="line">/**</div><div class="line"> * HDFS工具类</div><div class="line"> * </div><div class="line"> * 实现功能：</div><div class="line"> * hadoop fs -ls / </div><div class="line"> * hadoop fs -mkdir /data </div><div class="line"> * hadoop fs -rmr /data/test.txt</div><div class="line"> * hadoop fs -copyFromLocal /test/test.txt /data </div><div class="line"> * hadoop fs -cat /data/test.txt</div><div class="line"> * hadoop fs -copyToLocal /data /test/test.txt </div><div class="line"> * 创建一个新文件，并写入内容  </div><div class="line"> * 重命名</div><div class="line"> * </div><div class="line"> * 需要导入以下路径的所有jar包： hadoop-2.7.2\share\hadoop\common</div><div class="line"> * hadoop-2.7.2\share\hadoop\common\lib hadoop-2.7.2\share\hadoop\hdfs</div><div class="line"> * hadoop-2.7.2\share\hadoop\hdfs\lib hadoop-2.7.2\share\hadoop\mapreduce</div><div class="line"> * </div><div class="line"> * </div><div class="line"> * @author Skye</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class HdfsDAO &#123;</div><div class="line"></div><div class="line">	// HDFS访问地址</div><div class="line">	private static final String HDFS = &quot;hdfs://192.168.1.111:9000/&quot;;</div><div class="line">	// hdfs路径</div><div class="line">	private String hdfsPath;</div><div class="line">	// Hadoop系统配置</div><div class="line">	private Configuration conf;</div><div class="line"></div><div class="line">	public HdfsDAO(Configuration conf) &#123;</div><div class="line">		this(HDFS, conf);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public HdfsDAO(String hdfs, Configuration conf) &#123;</div><div class="line">		this.hdfsPath = hdfs;</div><div class="line">		this.conf = conf;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// 启动函数</div><div class="line">	public static void main(String[] args) throws IOException &#123;</div><div class="line">		JobConf conf = config();</div><div class="line">		HdfsDAO hdfs = new HdfsDAO(conf);</div><div class="line">		// hdfs.mkdirs(&quot;/new&quot;);</div><div class="line">		// 可以同时建多级目录</div><div class="line">		// hdfs.mkdirs(&quot;/new/new3&quot;);</div><div class="line">		// hdfs.ls(&quot;/tuijian&quot;);</div><div class="line">		// hdfs.rmr(&quot;/new&quot;);</div><div class="line">		// 可用当前eclipse工作空间的相对路径和文件绝对路径 以及当前项目的路径不加&quot;/&quot;</div><div class="line">		// hdfs.copyFileToHdfs(&quot;data/hive笔记.md&quot;, &quot;/data&quot;);</div><div class="line">		// hdfs.copyFileToHdfs(&quot;/Xiaomi/MiFlashClean.cmd&quot;, &quot;/data&quot;);</div><div class="line">		// hdfs.copyFileToHdfs(&quot;E:/推荐系统/100万用户数据/user_pay&quot;, &quot;/data&quot;);</div><div class="line">		// hdfs.rmr(&quot;/data/MiFlashClean.cmd&quot;);</div><div class="line">		// hdfs.rmr(&quot;/data/user_pay_201606&quot;);</div><div class="line">		// hdfs.createFile(&quot;/new/createTest&quot;, &quot;1,英雄联盟&quot;);</div><div class="line">		// hdfs.download(&quot;/data/RecommendList&quot;, &quot;C:/Users/Skye/Desktop&quot;);</div><div class="line">		// hdfs.cat(&quot;/data/RecommendList1&quot;);</div><div class="line">		// hdfs.renameFile(&quot;/data/RecommendList&quot;, &quot;/data/RecommendListOld&quot;);</div><div class="line">		// hdfs.ls(&quot;/data&quot;);</div><div class="line">		//hdfs.findLocationOnHadoop(&quot;/data/RecommendListOld&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// 加载Hadoop配置文件</div><div class="line">	public static JobConf config() &#123;</div><div class="line">		JobConf conf = new JobConf(HdfsDAO.class);</div><div class="line">		conf.setJobName(&quot;HdfsDAO&quot;);</div><div class="line">		// conf.addResource(&quot;classpath:/hadoop/core-site.xml&quot;);</div><div class="line">		// conf.addResource(&quot;classpath:/hadoop/hdfs-site.xml&quot;);</div><div class="line">		// conf.addResource(&quot;classpath:/hadoop/mapred-site.xml&quot;);</div><div class="line">		return conf;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void mkdirs(String folder) throws IOException &#123;</div><div class="line">		Path path = new Path(folder);</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		if (!fs.exists(path)) &#123;</div><div class="line">			fs.mkdirs(path);</div><div class="line">			System.out.println(&quot;Create: &quot; + folder);</div><div class="line">		&#125;</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void rmr(String folder) throws IOException &#123;</div><div class="line">		Path path = new Path(folder);</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		fs.deleteOnExit(path);</div><div class="line">		System.out.println(&quot;Delete: &quot; + folder);</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void ls(String folder) throws IOException &#123;</div><div class="line">		Path path = new Path(folder);</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		FileStatus[] list = fs.listStatus(path);</div><div class="line">		System.out.println(&quot;ls: &quot; + folder);</div><div class="line">		System.out.println(&quot;==========================================================&quot;);</div><div class="line">		for (FileStatus f : list) &#123;</div><div class="line">			System.out.printf(&quot;name: %s, folder: %s, size: %d\n&quot;, f.getPath(), f.isDir(), f.getLen());</div><div class="line">		&#125;</div><div class="line">		System.out.println(&quot;==========================================================&quot;);</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void createFile(String file, String content) throws IOException &#123;</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		byte[] buff = content.getBytes();</div><div class="line">		FSDataOutputStream os = null;</div><div class="line">		try &#123;</div><div class="line">			os = fs.create(new Path(file));</div><div class="line">			os.write(buff, 0, buff.length);</div><div class="line">			System.out.println(&quot;Create: &quot; + file);</div><div class="line">		&#125; finally &#123;</div><div class="line">			if (os != null)</div><div class="line">				os.close();</div><div class="line">		&#125;</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void copyFileToHdfs(String local, String remote) throws IOException &#123;</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		fs.copyFromLocalFile(new Path(local), new Path(remote));</div><div class="line">		System.out.println(&quot;copy from: &quot; + local + &quot; to &quot; + remote);</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void download(String remote, String local) throws IOException &#123;</div><div class="line">		Path path = new Path(remote);</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		fs.copyToLocalFile(path, new Path(local));</div><div class="line">		System.out.println(&quot;download: from&quot; + remote + &quot; to &quot; + local);</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void renameFile(String oldFileName, String newFileName) throws IOException &#123;</div><div class="line">		boolean isSuccess = true;</div><div class="line"></div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		try &#123;</div><div class="line">			isSuccess = fs.rename(new Path(oldFileName), new Path(newFileName));</div><div class="line">		&#125; catch (IOException e) &#123;</div><div class="line">			isSuccess = false;</div><div class="line">		&#125;</div><div class="line">		System.out.println(isSuccess ? &quot;Rename success！ &quot; + oldFileName + &quot; to &quot; + newFileName</div><div class="line">				: &quot;Rename failed！&quot; + oldFileName + &quot; to &quot; + newFileName);</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/**</div><div class="line">	 * 查看某个文件在HDFS集群的位置</div><div class="line">	 * </div><div class="line">	 * @throws IOException</div><div class="line">	 */</div><div class="line"></div><div class="line">	public void findLocationOnHadoop(String filePath) throws IOException &#123;</div><div class="line">		// Path targetFile=new Path(rootPath+&quot;user/hdfsupload/AA.txt&quot;);</div><div class="line">		// FileStatus fileStaus=coreSys.getFileStatus(targetFile);</div><div class="line">		Path targetFile = new Path(HDFS + filePath);</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		FileStatus fileStaus = fs.getFileStatus(targetFile);</div><div class="line">		BlockLocation[] bloLocations = fs.getFileBlockLocations(fileStaus, 0, fileStaus.getLen());</div><div class="line">		for (int i = 0; i &lt; bloLocations.length; i++) &#123;</div><div class="line">			System.out.println(&quot;block_&quot; + i + &quot;_location:&quot; + bloLocations[i].getHosts()[0]);</div><div class="line">		&#125;</div><div class="line">		fs.close();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void cat(String remoteFile) throws IOException &#123;</div><div class="line">		Path path = new Path(remoteFile);</div><div class="line">		FileSystem fs = FileSystem.get(URI.create(hdfsPath), conf);</div><div class="line">		FSDataInputStream fsdis = null;</div><div class="line">		System.out.println(&quot;cat: &quot; + remoteFile);</div><div class="line">		try &#123;</div><div class="line">			fsdis = fs.open(path);</div><div class="line">			IOUtils.copyBytes(fsdis, System.out, 4096, false);</div><div class="line">		&#125; finally &#123;</div><div class="line">			IOUtils.closeStream(fsdis);</div><div class="line">			fs.close();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="Skye" />
          <p class="site-author-name" itemprop="name">Skye</p>
           
              <p class="site-description motion-element" itemprop="description">学习总结 思想感悟</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">59</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">32</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/1811544100" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/Skyexu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Skye</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"skyexu"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  
















  





  

  

  

  

  

  

</body>
</html>
