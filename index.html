<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="学习总结 思想感悟">
<meta property="og:type" content="website">
<meta property="og:title" content="Skye's Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Skye's Blog">
<meta property="og:description" content="学习总结 思想感悟">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Skye's Blog">
<meta name="twitter:description" content="学习总结 思想感悟">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/"/>

  <title> Skye's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Skye's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Forever youthful,forever weeping</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/29/Jena学习笔记（二） SPARQL/" itemprop="url">
                  Jena学习笔记（二） SPARQL
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-29T22:11:29+08:00" content="2016-11-29">
              2016-11-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/paper/" itemprop="url" rel="index">
                    <span itemprop="name">paper</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/29/Jena学习笔记（二） SPARQL/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/29/Jena学习笔记（二） SPARQL/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>官方描述：Apache Jena（或简称Jena）是一个用于构建语义Web和关联数据应用程序的自由和开源的Java框架。 该框架由不同的API组成，用于处理RDF数据。</p>
<p>Jena是一个用于Java语义Web应用程序的API（应用程序编程接口）。它不是一个程序或工具，如果这是你正在寻找，我建议或许TopBraid Composer作为一个好的选择。因此，Jena的主要用途是帮助您编写处理RDF和OWL文档和描述的Java代码。</p>
<p>SPARQL是用于访问由W3C RDF数据访问工作组设计的RDF的查询语言和协议。</p>
<p>作为一种查询语言，SPARQL是“数据导向的”，因为它只查询模型中保存的信息;在查询语言本身没有推理。当然，Jena模型是“聪明的”，因为它提供了某些三元组存在的印象，即按需创建它们，包括OWL推理。除了以查询的形式获取应用程序想要的描述外，SPARQL不执行任何操作，并以一组bindings或RDF图形的形式返回该信息。</p>
</blockquote>
<p>官方网站：<a href="http://jena.apache.org/index.html" target="_blank" rel="external">http://jena.apache.org/index.html</a><br>SPARQL教程：<a href="http://jena.apache.org/tutorials/sparql.html" target="_blank" rel="external">http://jena.apache.org/tutorials/sparql.html</a></p>
<hr>
<h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Setting up your Environment</span><br><span class="line">An environment variable JENAROOT is used by all the command line tools to configure the class path automatically for you. You can set this up as follows:</span><br><span class="line"></span><br><span class="line">On Linux / Mac</span><br><span class="line"></span><br><span class="line">export JENAROOT=the directory you downloaded Jena to</span><br><span class="line">export PATH=$PATH:$JENAROOT/bin</span><br><span class="line">On Windows</span><br><span class="line"></span><br><span class="line">SET JENAROOT=the directory you downloaded Jena to</span><br><span class="line">SET PATH=%PATH%;%JENAROOT%\bat</span><br></pre></td></tr></table></figure>
<h3 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h3><p>首先，我们需要清楚查询要查询的数据。 SPARQL查询RDF图。 RDF图是一组三元组（Jena调用RDF图“模型”和三元组“语句”，因为这是他们在第一次设计Jena API时调用的）。</p>
<p>重要的是要意识到三元组的重要性，而不是序列化。序列化只是一种写三元组的方式。 RDF / XML是W3C的建议，但是可能很难看到序列化形式的三元组，因为有多种方法来编码同一个图。在本教程中，我们使用了一个更像“三元组”的序列化，称为Turtle（另请参阅W3C语义网络引文中描述的N3语言）。</p>
<p>我们将从vc-db-1.rdf中的简单数据开始：此文件包含用于多个vCard人员描述的RDF。 vCard在RFC2426中描述，并且RDF翻译在W3C笔记“在RDF / XML中表示vCard对象”中描述。我们的示例数据库只包含一些名称信息。</p>
<p>图形上，数据看起来像：<br><img src="http://i.imgur.com/Nd0fFky.png" alt=""></p>
<p>在三元组中，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@prefix vCard:   &lt;http://www.w3.org/2001/vcard-rdf/3.0#&gt; .</span><br><span class="line">@prefix rdf:     &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .</span><br><span class="line">@prefix :        &lt;#&gt; .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/MattJones/&gt;</span><br><span class="line">    vCard:FN    &quot;Matt Jones&quot; ;</span><br><span class="line">    vCard:N     [ vCard:Family</span><br><span class="line">                              &quot;Jones&quot; ;</span><br><span class="line">                  vCard:Given</span><br><span class="line">                              &quot;Matthew&quot;</span><br><span class="line">                ] .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/RebeccaSmith/&gt;</span><br><span class="line">    vCard:FN    &quot;Becky Smith&quot; ;</span><br><span class="line">    vCard:N     [ vCard:Family</span><br><span class="line">                              &quot;Smith&quot; ;</span><br><span class="line">                  vCard:Given</span><br><span class="line">                              &quot;Rebecca&quot;</span><br><span class="line">                ] .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/JohnSmith/&gt;</span><br><span class="line">    vCard:FN    &quot;John Smith&quot; ;</span><br><span class="line">    vCard:N     [ vCard:Family</span><br><span class="line">                              &quot;Smith&quot; ;</span><br><span class="line">                  vCard:Given</span><br><span class="line">                              &quot;John&quot;</span><br><span class="line">                ] .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/SarahJones/&gt;</span><br><span class="line">    vCard:FN    &quot;Sarah Jones&quot; ;</span><br><span class="line">    vCard:N     [ vCard:Family</span><br><span class="line">                              &quot;Jones&quot; ;</span><br><span class="line">                  vCard:Given</span><br><span class="line">                              &quot;Sarah&quot;</span><br><span class="line">                ] .</span><br></pre></td></tr></table></figure></p>
<p>更加明确的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@prefix vCard:   &lt;http://www.w3.org/2001/vcard-rdf/3.0#&gt; .</span><br><span class="line">@prefix rdf:     &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/MattJones/&gt;  vCard:FN   &quot;Matt Jones&quot; .</span><br><span class="line">&lt;http://somewhere/MattJones/&gt;  vCard:N    _:b0 .</span><br><span class="line">_:b0  vCard:Family &quot;Jones&quot; .</span><br><span class="line">_:b0  vCard:Given  &quot;Matthew&quot; .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/RebeccaSmith/&gt; vCard:FN    &quot;Becky Smith&quot; .</span><br><span class="line">&lt;http://somewhere/RebeccaSmith/&gt; vCard:N     _:b1 .</span><br><span class="line">_:b1 vCard:Family &quot;Smith&quot; .</span><br><span class="line">_:b1 vCard:Given  &quot;Rebecca&quot; .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/JohnSmith/&gt;    vCard:FN    &quot;John Smith&quot; .</span><br><span class="line">&lt;http://somewhere/JohnSmith/&gt;    vCard:N     _:b2 .</span><br><span class="line">_:b2 vCard:Family &quot;Smith&quot; .</span><br><span class="line">_:b2 vCard:Given  &quot;John&quot;  .</span><br><span class="line"></span><br><span class="line">&lt;http://somewhere/SarahJones/&gt;   vCard:FN    &quot;Sarah Jones&quot; .</span><br><span class="line">&lt;http://somewhere/SarahJones/&gt;   vCard:N     _:b3 .</span><br><span class="line">_:b3 vCard:Family  &quot;Jones&quot; .</span><br><span class="line">_:b3 vCard:Given   &quot;Sarah&quot; .</span><br></pre></td></tr></table></figure></p>
<p>重要的是要意识到这些是相同的RDF图，并且图中的三元组没有特定的顺序。计算机不在乎其顺序。</p>
<h3 id="第一个SPARQL查询"><a href="#第一个SPARQL查询" class="headerlink" title="第一个SPARQL查询"></a>第一个SPARQL查询</h3><p>看一个简单的查询并展示如何使用Jena执行它。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT ?x</span><br><span class="line">WHERE &#123; ?x  &lt;http://www.w3.org/2001/vcard-rdf/3.0#FN&gt;  &quot;John Smith&quot; &#125;</span><br></pre></td></tr></table></figure></p>
<p>用命令行查询应用程序执行所述查询:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------</span><br><span class="line">| x                             |</span><br><span class="line">=================================</span><br><span class="line">| &lt;http://somewhere/JohnSmith/&gt; |</span><br><span class="line">---------------------------------</span><br></pre></td></tr></table></figure></p>
<p>这通过将WHERE子句中的三元模式与RDF图中的三元组进行匹配来实现。三元组的谓词和对象是固定值，因此模式将只匹配与这些值的三元组。主体是一个变量，并且对变量没有其他限制。模式匹配任何三元组与这些谓词和对象值，它匹配x的结果。</p>
<p>&lt;&gt;中包含的项目是一个URI（实际上是一个IRI），而包含在“”中的项目是一个普通的字面量。就像Turtle，N3或N-triples一样，输入的文字用\ ^ \ ^编写，语言标签可以用@添加。</p>
<p>？x是一个称为x的变量。？不会形成名称的一部分，这就是为什么它不会出现在表的输出中。<br>该查询返回x查询变量中的匹配项。所示的输出是通过一条ARQ的命令获得的。</p>
<h4 id="执行查询"><a href="#执行查询" class="headerlink" title="执行查询"></a>执行查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Windows setup</span><br><span class="line">Execute:</span><br><span class="line"></span><br><span class="line">bat\sparql.bat --data=doc\Tutorial\vc-db-1.rdf --query=doc\Tutorial\q1.rq</span><br><span class="line">You can just put the bat/ directory on your classpath or copy the programs out of it.</span><br><span class="line"></span><br><span class="line">bash scripts for Linux/Cygwin/Unix</span><br><span class="line">Execute:</span><br><span class="line"></span><br><span class="line">bin/sparql --data=doc/Tutorial/vc-db-1.rdf --query=doc/Tutorial/q1.rq</span><br></pre></td></tr></table></figure>
<p>在Linux中执行结果<br><img src="http://i.imgur.com/HvWk6xW.png" alt=""></p>
<h4 id="获取所有人的FullName"><a href="#获取所有人的FullName" class="headerlink" title="获取所有人的FullName"></a>获取所有人的FullName</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT ?x ?fname</span><br><span class="line">WHERE &#123;?x  &lt;http://www.w3.org/2001/vcard-rdf/3.0#FN&gt;  ?fname&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//执行</span><br><span class="line">ubuntu@master:~/paper/doc$ sparql --data=vc-db-1.rdf --query=q-bp1.rq</span><br><span class="line">----------------------------------------------------</span><br><span class="line">| x                                | fname         |</span><br><span class="line">====================================================</span><br><span class="line">| &lt;http://somewhere/JohnSmith/&gt;    | &quot;John Smith&quot;  |</span><br><span class="line">| &lt;http://somewhere/SarahJones/&gt;   | &quot;Sarah Jones&quot; |</span><br><span class="line">| &lt;http://somewhere/MattJones/&gt;    | &quot;Matt Jones&quot;  |</span><br><span class="line">| &lt;http://somewhere/RebeccaSmith/&gt; | &quot;Becky Smith&quot; |</span><br><span class="line">----------------------------------------------------</span><br></pre></td></tr></table></figure>
<h4 id="指定前缀"><a href="#指定前缀" class="headerlink" title="指定前缀"></a>指定前缀</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@master:~/paper/doc$ cat q2.rq </span><br><span class="line">PREFIX vCard:      &lt;http://www.w3.org/2001/vcard-rdf/3.0#&gt;</span><br><span class="line"></span><br><span class="line">SELECT ?x</span><br><span class="line">WHERE</span><br><span class="line"> &#123; ?x vCard:FN &quot;John Smith&quot; &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@master:~/paper/doc$ sparql --data=vc-db-1.rdf --query=q2.rq</span><br><span class="line">---------------------------------</span><br><span class="line">| x                             |</span><br><span class="line">=================================</span><br><span class="line">| &lt;http://somewhere/JohnSmith/&gt; |</span><br><span class="line">---------------------------------</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/26/Jena学习笔记（一） RDF/" itemprop="url">
                  Jena学习笔记（一） RDF
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-26T22:56:02+08:00" content="2016-11-26">
              2016-11-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/paper/" itemprop="url" rel="index">
                    <span itemprop="name">paper</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/26/Jena学习笔记（一） RDF/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/26/Jena学习笔记（一） RDF/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>官方描述：Apache Jena（或简称Jena）是一个用于构建语义Web和关联数据应用程序的自由和开源的Java框架。 该框架由不同的API组成，用于处理RDF数据。</p>
<p>Jena是一个用于Java语义Web应用程序的API（应用程序编程接口）。它不是一个程序或工具，如果这是你正在寻找，我建议或许TopBraid Composer作为一个好的选择。因此，Jena的主要用途是帮助您编写处理RDF和OWL文档和描述的Java代码。</p>
</blockquote>
<p>官方网站：<a href="http://jena.apache.org/index.html" target="_blank" rel="external">http://jena.apache.org/index.html</a><br>RDF API教程：<a href="http://jena.apache.org/tutorials/rdf_api.html" target="_blank" rel="external">http://jena.apache.org/tutorials/rdf_api.html</a></p>
<hr>
<h3 id="RDF定义"><a href="#RDF定义" class="headerlink" title="RDF定义"></a>RDF定义</h3><p>资源描述框架（RDF）是最初设计为元数据数据模型的万维网联盟（W3C）规范[1]的家族。 它已经被用作用于概念描述或者在web资源中实现的信息的建模的一般方法，使用各种语法符号和数据串行化格式。 它也用于知识管理应用程序中。<br>RDF数据模型类似于诸如实体关系或类图的经典概念建模方法，因为它基于以主语谓词对象的形式对资源（特别是web资源）进行语句表。这些表达式在RDF术语中称为三元组。主语表示资源，谓词表示资源的特征或方面，并且表示主语和对象之间的关系。例如，在RDF中表示“天空具有蓝色”的概念的一种方式是作为三元组：表示“天空”的主题，表示“具有颜色”的谓词和表示“蓝色”的对象。因此，RDF将面向对象设计中的实体 - 属性 - 值模型的经典符号中使用的对象交换对象;实体（天空），属性（颜色）和值（蓝色）。 RDF是具有几种串行格式（即，文件格式）的抽象模型，因此资源或三元组被编码的特定方式随格式而变化。</p>
<h3 id="下载Jena并从Eclipse建立工程，导入jar"><a href="#下载Jena并从Eclipse建立工程，导入jar" class="headerlink" title="下载Jena并从Eclipse建立工程，导入jar"></a>下载Jena并从Eclipse建立工程，导入jar</h3><ul>
<li>RDF API 教程 <a href="http://jena.apache.org/tutorials/rdf_api.html" target="_blank" rel="external">http://jena.apache.org/tutorials/rdf_api.html</a></li>
</ul>
<h3 id="建立如下RDF图并打印"><a href="#建立如下RDF图并打印" class="headerlink" title="建立如下RDF图并打印"></a>建立如下RDF图并打印</h3><p><img src="http://i.imgur.com/m8ZtRNG.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">package com.hdu.rdf;</span><br><span class="line"></span><br><span class="line">import org.apache.jena.rdf.model.Model;</span><br><span class="line">import org.apache.jena.rdf.model.ModelFactory;</span><br><span class="line">import org.apache.jena.rdf.model.Property;</span><br><span class="line">import org.apache.jena.rdf.model.RDFNode;</span><br><span class="line">import org.apache.jena.rdf.model.Resource;</span><br><span class="line">import org.apache.jena.rdf.model.Statement;</span><br><span class="line">import org.apache.jena.rdf.model.StmtIterator;</span><br><span class="line">import org.apache.jena.vocabulary.VCARD;</span><br><span class="line"></span><br><span class="line">public class Tutorial2AddProperty &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		// some definitions</span><br><span class="line">		String personURI = &quot;http://somewhere/JohnSmith&quot;;</span><br><span class="line">		String givenName = &quot;John&quot;;</span><br><span class="line">		String familyName = &quot;Smith&quot;;</span><br><span class="line">		String fullName = givenName + &quot; &quot; + familyName;</span><br><span class="line"></span><br><span class="line">		// create an empty model</span><br><span class="line">		Model model = ModelFactory.createDefaultModel();</span><br><span class="line"></span><br><span class="line">		// create the resource</span><br><span class="line">		// and add the properties cascading style</span><br><span class="line">		Resource johnSmith = model.createResource(personURI).addProperty(VCARD.FN, fullName).addProperty(VCARD.N,</span><br><span class="line">				model.createResource().addProperty(VCARD.Given, givenName).addProperty(VCARD.Family, familyName));</span><br><span class="line">		// model.write(System.out);</span><br><span class="line"></span><br><span class="line">		// list the statements in the graph</span><br><span class="line">		StmtIterator iter = model.listStatements();</span><br><span class="line">		// print out the predicate, subject and object of each statement</span><br><span class="line">		while (iter.hasNext()) &#123;</span><br><span class="line">			Statement stmt = iter.nextStatement();</span><br><span class="line">			Resource subject = stmt.getSubject(); // get the subject</span><br><span class="line">			Property predicate = stmt.getPredicate(); // get the predicate</span><br><span class="line">			RDFNode object = stmt.getObject(); // get the object</span><br><span class="line"></span><br><span class="line">			System.out.print(subject.toString());</span><br><span class="line">			System.out.print(&quot; &quot; + predicate.toString() + &quot; &quot;);</span><br><span class="line">			if (object instanceof Resource) &#123;</span><br><span class="line">				System.out.print(object.toString());</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				// object is a literal</span><br><span class="line">				System.out.print(&quot; \&quot;&quot; + object.toString() + &quot;\&quot;&quot;);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			System.out.println(&quot; .&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>结果</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//iterator遍历 每行包含三个字段，表示每个语句的主题，谓词和对象</span><br><span class="line">http://somewhere/JohnSmith http://www.w3.org/2001/vcard-rdf/3.0#N anon:14df86:ecc3dee17b:-7fff .</span><br><span class="line">anon:14df86:ecc3dee17b:-7fff http://www.w3.org/2001/vcard-rdf/3.0#Family  &quot;Smith&quot; .</span><br><span class="line">anon:14df86:ecc3dee17b:-7fff http://www.w3.org/2001/vcard-rdf/3.0#Given  &quot;John&quot; .</span><br><span class="line">http://somewhere/JohnSmith http://www.w3.org/2001/vcard-rdf/3.0#FN  &quot;John Smith&quot; .</span><br><span class="line"></span><br><span class="line">//write输出  xml格式</span><br><span class="line">&lt;rdf:RDF</span><br><span class="line">  xmlns:rdf=&apos;http://www.w3.org/1999/02/22-rdf-syntax-ns#&apos;</span><br><span class="line">  xmlns:vcard=&apos;http://www.w3.org/2001/vcard-rdf/3.0#&apos;</span><br><span class="line"> &gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&apos;http://somewhere/JohnSmith&apos;&gt;</span><br><span class="line">    &lt;vcard:FN&gt;John Smith&lt;/vcard:FN&gt;</span><br><span class="line">    &lt;vcard:N rdf:nodeID=&quot;A0&quot;/&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:nodeID=&quot;A0&quot;&gt;</span><br><span class="line">    &lt;vcard:Given&gt;John&lt;/vcard:Given&gt;</span><br><span class="line">    &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">&lt;/rdf:RDF&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>说明</strong></p>
<p>他的RDF规范指定如何将RDF表示为XML。 RDF XML语法相当复杂。读者参考由RDFCore WG开发的引物以进行更详细的介绍。但是，让我们快速看看如何解释上面的。</p>
<p>RDF通常嵌入在<rdf：rdf>元素中。如果有其他方式知道某些XML是RDF，但是它通常存在，那么该元素是可选的。 RDF元素定义文档中使用的两个命名空间。然后是一个<rdf：description>元素，描述其URI为“http：// somewhere / JohnSmith”的资源。如果缺少rdf：about属性，则此元素将表示空白节点。</rdf：description></rdf：rdf></p>
<p><vcard：fn>元素描述了资源的属性。属性名称是vcard命名空间中的“FN”。 RDF通过连接命名空间前缀的URI引用和名称的本地名称部分的“FN”，将其转换为URI引用。这提供了一个URI引用”<a href="http://www.w3.org/2001/vcard-rdf/3.0#FN&quot;。属性的值是文字&quot;John" target="_blank" rel="external">http://www.w3.org/2001/vcard-rdf/3.0#FN&quot;。属性的值是文字&quot;John</a> Smith”。</vcard：fn></p>
<p><vcard：n>元素是一个资源。在这种情况下，资源由相对URI引用表示。 RDF通过将其与当前文档的基本URI连接，将其转换为绝对URI引用。</vcard：n></p>
<p>此RDF XML中有错误;它不完全代表我们创建的模型。模型中的空白节点已经被赋予URI引用。它不再是空白。 RDF / XML语法不能表示所有RDF模型;例如它不能表示作为两个语句的对象的空白节点。我们用来编写这个RDF / XML的’dumb’作者没有尝试正确地写入可以正确写入的Models子集。它为每个空白节点提供一个URI，使其不再为空。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// now write the model in XML form to a file</span><br><span class="line">model.write(System.out, &quot;RDF/XML-ABBREV&quot;);</span><br><span class="line"></span><br><span class="line">// now write the model in N-TRIPLES form to a file</span><br><span class="line">model.write(System.out, &quot;N-TRIPLES&quot;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;rdf:RDF</span><br><span class="line">    xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><br><span class="line">    xmlns:vcard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot;&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&quot;http://somewhere/JohnSmith&quot;&gt;</span><br><span class="line">    &lt;vcard:N rdf:parseType=&quot;Resource&quot;&gt;</span><br><span class="line">      &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">      &lt;vcard:Given&gt;John&lt;/vcard:Given&gt;</span><br><span class="line">    &lt;/vcard:N&gt;</span><br><span class="line">    &lt;vcard:FN&gt;John Smith&lt;/vcard:FN&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">&lt;/rdf:RDF&gt;</span><br><span class="line">&lt;http://somewhere/JohnSmith&gt; &lt;http://www.w3.org/2001/vcard-rdf/3.0#N&gt; _:BX2D71b38d8eX3A1589596bd63X3AX2D7fff .</span><br><span class="line">&lt;http://somewhere/JohnSmith&gt; &lt;http://www.w3.org/2001/vcard-rdf/3.0#FN&gt; &quot;John Smith&quot; .</span><br><span class="line">_:BX2D71b38d8eX3A1589596bd63X3AX2D7fff &lt;http://www.w3.org/2001/vcard-rdf/3.0#Family&gt; &quot;Smith&quot; .</span><br><span class="line">_:BX2D71b38d8eX3A1589596bd63X3AX2D7fff &lt;http://www.w3.org/2001/vcard-rdf/3.0#Given&gt; &quot;John&quot; .</span><br></pre></td></tr></table></figure>
<h3 id="读取RDF"><a href="#读取RDF" class="headerlink" title="读取RDF"></a>读取RDF</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">static final String inputFileName = &quot;vc-db-1.rdf&quot;;</span><br><span class="line"></span><br><span class="line"> // create an empty model</span><br><span class="line"> Model model = ModelFactory.createDefaultModel();</span><br><span class="line"></span><br><span class="line"> // use the FileManager to find the input file</span><br><span class="line"> InputStream in = FileManager.get().open( inputFileName );</span><br><span class="line">if (in == null) &#123;</span><br><span class="line">    throw new IllegalArgumentException(</span><br><span class="line">                                 &quot;File: &quot; + inputFileName + &quot; not found&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// read the RDF/XML file</span><br><span class="line">model.read(in, null);</span><br><span class="line"></span><br><span class="line">// write it to standard out</span><br><span class="line">model.write(System.out);</span><br></pre></td></tr></table></figure>
<p><strong>读取结果</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;rdf:RDF</span><br><span class="line">  xmlns:rdf=&apos;http://www.w3.org/1999/02/22-rdf-syntax-ns#&apos;</span><br><span class="line">  xmlns:vcard=&apos;http://www.w3.org/2001/vcard-rdf/3.0#&apos;</span><br><span class="line"> &gt;</span><br><span class="line">  &lt;rdf:Description rdf:nodeID=&quot;A0&quot;&gt;</span><br><span class="line">    &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;vcard:Given&gt;John&lt;/vcard:Given&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&apos;http://somewhere/JohnSmith/&apos;&gt;</span><br><span class="line">    &lt;vcard:FN&gt;John Smith&lt;/vcard:FN&gt;</span><br><span class="line">    &lt;vcard:N rdf:nodeID=&quot;A0&quot;/&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&apos;http://somewhere/SarahJones/&apos;&gt;</span><br><span class="line">    &lt;vcard:FN&gt;Sarah Jones&lt;/vcard:FN&gt;</span><br><span class="line">    &lt;vcard:N rdf:nodeID=&quot;A1&quot;/&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&apos;http://somewhere/MattJones/&apos;&gt;</span><br><span class="line">    &lt;vcard:FN&gt;Matt Jones&lt;/vcard:FN&gt;</span><br><span class="line">    &lt;vcard:N rdf:nodeID=&quot;A2&quot;/&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:nodeID=&quot;A3&quot;&gt;</span><br><span class="line">    &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;vcard:Given&gt;Rebecca&lt;/vcard:Given&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:nodeID=&quot;A1&quot;&gt;</span><br><span class="line">    &lt;vcard:Family&gt;Jones&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;vcard:Given&gt;Sarah&lt;/vcard:Given&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:nodeID=&quot;A2&quot;&gt;</span><br><span class="line">    &lt;vcard:Family&gt;Jones&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;vcard:Given&gt;Matthew&lt;/vcard:Given&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&apos;http://somewhere/RebeccaSmith/&apos;&gt;</span><br><span class="line">    &lt;vcard:FN&gt;Becky Smith&lt;/vcard:FN&gt;</span><br><span class="line">    &lt;vcard:N rdf:nodeID=&quot;A3&quot;/&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">&lt;/rdf:RDF&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Jena-RDF包"><a href="#Jena-RDF包" class="headerlink" title="Jena RDF包"></a>Jena RDF包</h3><p>Jena是用于语义Web应用程序的Java API。应用程序开发人员的关键RDF包是org.apache.jena.rdf.model。 API已经根据接口进行了定义，以便应用程序代码可以在不改变的情况下与不同的实现工作。此包包含用于表示模型，资源，属性，文字，语句和RDF的所有其他关键概念的接口，以及用于创建模型的ModelFactory。所以应用程序代码保持独立的实现，最好是尽可能使用接口，而不是特定的类实现。</p>
<p>org.apache.jena.tutorial包包含本教程中使用的所有示例的工作源代码。</p>
<p>org.apache.jena … impl包包含可能对许多实现通用的实现类。例如，它们定义类ResourceImpl，PropertyImpl和LiteralImpl，它们可以被不同的实现直接使用或子类化。应用程序应该很少，如果有的话，直接使用这些类。例如，不是创建ResourceImpl的新实例，最好使用正在使用的任何模型的createResource方法。这样，如果模型实现使用了Resource的优化实现，则两种类型之间不需要转换。</p>
<h3 id="浏览模型"><a href="#浏览模型" class="headerlink" title="浏览模型"></a>浏览模型</h3><p>给定资源的URI，可以使用Model.getResource（String uri）方法从模型中检索资源对象。 此方法定义为返回一个Resource对象（如果模型中存在），否则创建一个新对象。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">static final String inputFileName = &quot;vc-db-1.rdf&quot;;</span><br><span class="line">    static final String johnSmithURI = &quot;http://somewhere/JohnSmith/&quot;;</span><br><span class="line">    </span><br><span class="line">    public static void main (String args[]) &#123;</span><br><span class="line">        // create an empty model</span><br><span class="line">        Model model = ModelFactory.createDefaultModel();</span><br><span class="line">       </span><br><span class="line">        // use the FileManager to find the input file</span><br><span class="line">        InputStream in = FileManager.get().open(inputFileName);</span><br><span class="line">        if (in == null) &#123;</span><br><span class="line">            throw new IllegalArgumentException( &quot;File: &quot; + inputFileName + &quot; not found&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        // read the RDF/XML file</span><br><span class="line">        model.read(new InputStreamReader(in), &quot;&quot;);</span><br><span class="line">        </span><br><span class="line">        // retrieve the Adam Smith vcard resource from the model</span><br><span class="line">        Resource vcard = model.getResource(johnSmithURI);</span><br><span class="line"></span><br><span class="line">        // retrieve the value of the N property</span><br><span class="line">        Resource name = (Resource) vcard.getRequiredProperty(VCARD.N)</span><br><span class="line">                                        .getObject();</span><br><span class="line">        // retrieve the given name property</span><br><span class="line">        String fullName = vcard.getRequiredProperty(VCARD.FN)</span><br><span class="line">                               .getString();</span><br><span class="line">        // add two nick name properties to vcard</span><br><span class="line">		// 获取johnSmithURI资源后，对其添加两个nickname属性</span><br><span class="line">        vcard.addProperty(VCARD.NICKNAME, &quot;Smithy&quot;)</span><br><span class="line">             .addProperty(VCARD.NICKNAME, &quot;Adman&quot;);</span><br><span class="line">        </span><br><span class="line">        // set up the output</span><br><span class="line">        System.out.println(&quot;The nicknames of \&quot;&quot; + fullName + &quot;\&quot; are:&quot;);</span><br><span class="line">        // list the nicknames</span><br><span class="line">		//返回声明迭代器，获取对象</span><br><span class="line">        StmtIterator iter = vcard.listProperties(VCARD.NICKNAME);</span><br><span class="line">        while (iter.hasNext()) &#123;</span><br><span class="line">            System.out.println(&quot;    &quot; + iter.nextStatement().getObject()</span><br><span class="line">                                            .toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The nicknames of &quot;John Smith&quot; are:</span><br><span class="line">    Adman</span><br><span class="line">    Smithy</span><br></pre></td></tr></table></figure>
<h3 id="查询模型"><a href="#查询模型" class="headerlink" title="查询模型"></a>查询模型</h3><p>上一节讨论从具有已知URI的资源导航模型的情况。 本节介绍搜索模型。 核心Jena API仅支持有限的查询原语。 更强大的查询功能在SPARQL中。</p>
<p>Model.listStatements（）方法列出了模型中的所有语句，也许是查询模型的最粗糙的方法。 它的使用不推荐在非常大的模型。 Model.listSubjects（）是类似的，但返回一个迭代器在所有具有属性的资源，即一些语句的主题。</p>
<p>Model.listSubjectsWithProperty（Property p，RDFNode o）将返回所有资源的迭代器，这些资源具有值为o的属性p。 如果我们假设只有vcard资源会有vcard：FN属性，并且在我们的数据中，所有这些资源都有这样的属性，那么我们可以找到所有的vcards：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">static final String inputFileName = &quot;vc-db-1.rdf&quot;;</span><br><span class="line">   </span><br><span class="line">   public static void main (String args[]) &#123;</span><br><span class="line">       // create an empty model</span><br><span class="line">       Model model = ModelFactory.createDefaultModel();</span><br><span class="line">      </span><br><span class="line">       // use the FileManager to find the input file</span><br><span class="line">       InputStream in = FileManager.get().open(inputFileName);</span><br><span class="line">       if (in == null) &#123;</span><br><span class="line">           throw new IllegalArgumentException( &quot;File: &quot; + inputFileName + &quot; not found&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       // read the RDF/XML file</span><br><span class="line">       model.read( in, &quot;&quot;);</span><br><span class="line">       </span><br><span class="line">       // select all the resources with a VCARD.FN property</span><br><span class="line">       ResIterator iter = model.listResourcesWithProperty(VCARD.FN);</span><br><span class="line">       if (iter.hasNext()) &#123;</span><br><span class="line">           System.out.println(&quot;The database contains vcards for:&quot;);</span><br><span class="line">           while (iter.hasNext()) &#123;</span><br><span class="line">               System.out.println(&quot;  &quot; + iter.nextResource()</span><br><span class="line">                                             .getRequiredProperty(VCARD.FN)</span><br><span class="line">                                             .getString() );</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           System.out.println(&quot;No vcards were found in the database&quot;);</span><br><span class="line">       &#125;            </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The database contains vcards for:</span><br><span class="line">  Sarah Jones</span><br><span class="line">  John Smith</span><br><span class="line">  Becky Smith</span><br><span class="line">  Matt Jones</span><br></pre></td></tr></table></figure>
<h3 id="模型操作"><a href="#模型操作" class="headerlink" title="模型操作"></a>模型操作</h3><p>Jena提供了操作模型作为一个整体的三个操作,分別是并集，交集和差的运算。</p>
<p>两个模型的并集是表示每个模型的语句集合的合并。这是RDF设计支持的关键操作之一。它允许合并来自不同数据源的数据。 考虑以下两个模型：<br><img src="http://i.imgur.com/F1ooVdI.png" alt=""> <img src="http://i.imgur.com/HDmwweL.png" alt=""></p>
<p>当这些被合并时，两个http：//…JohnSmith节点被合并成一个，并且vcard：FN 弧被丢弃以产生：<br><img src="http://i.imgur.com/6cZO0rR.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">static final String inputFileName1 = &quot;vc-db-3.rdf&quot;;    </span><br><span class="line"> static final String inputFileName2 = &quot;vc-db-4.rdf&quot;;</span><br><span class="line"> </span><br><span class="line"> public static void main (String args[]) &#123;</span><br><span class="line">     // create an empty model</span><br><span class="line">     Model model1 = ModelFactory.createDefaultModel();</span><br><span class="line">     Model model2 = ModelFactory.createDefaultModel();</span><br><span class="line">    </span><br><span class="line">     // use the class loader to find the input file</span><br><span class="line">     InputStream in1 = FileManager.get().open(inputFileName1);</span><br><span class="line">     if (in1 == null) &#123;</span><br><span class="line">         throw new IllegalArgumentException( &quot;File: &quot; + inputFileName1 + &quot; not found&quot;);</span><br><span class="line">     &#125;</span><br><span class="line">     InputStream in2 = FileManager.get().open(inputFileName2);</span><br><span class="line">     if (in2 == null) &#123;</span><br><span class="line">         throw new IllegalArgumentException( &quot;File: &quot; + inputFileName2 + &quot; not found&quot;);</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     // read the RDF/XML files</span><br><span class="line">     model1.read( in1, &quot;&quot; );</span><br><span class="line">     model2.read( in2, &quot;&quot; );</span><br><span class="line">     </span><br><span class="line">     // merge the graphs</span><br><span class="line">     Model model = model1.union(model2);</span><br><span class="line">     </span><br><span class="line">     // print the graph as RDF/XML</span><br><span class="line">     model.write(System.out, &quot;RDF/XML-ABBREV&quot;);</span><br><span class="line">     System.out.println();</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;rdf:RDF</span><br><span class="line">    xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><br><span class="line">    xmlns:vcard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot;&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&quot;http://somewhere/JohnSmith/&quot;&gt;</span><br><span class="line">    &lt;vcard:N rdf:parseType=&quot;Resource&quot;&gt;</span><br><span class="line">      &lt;vcard:Given&gt;John&lt;/vcard:Given&gt;</span><br><span class="line">      &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;/vcard:N&gt;</span><br><span class="line">    &lt;vcard:EMAIL&gt;</span><br><span class="line">      &lt;vcard:internet&gt;</span><br><span class="line">        &lt;rdf:value&gt;John@somewhere.com&lt;/rdf:value&gt;</span><br><span class="line">      &lt;/vcard:internet&gt;</span><br><span class="line">    &lt;/vcard:EMAIL&gt;</span><br><span class="line">    &lt;vcard:FN&gt;John Smith&lt;/vcard:FN&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">&lt;/rdf:RDF&gt;</span><br></pre></td></tr></table></figure>
<h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><p>RDF定义了一种特殊的资源来表示事物的集合。 这些资源称为容器。 容器的成员可以是文字或资源。 有三种容器：</p>
<p>BAG是一个无序的集合<br>ALT是旨在表示可选的无序集合<br>SEQ是有序集合<br>容器由资源表示。 该资源将有一个rdf：type属性，其值应为rdf：Bag，rdf：Alt或rdf：Seq之一，或其中一个的子类，具体取决于容器的类型。 容器的第一个成员是容器的rdf：_1属性的值; 容器的第二个成员是容器的rdf：_2属性的值，等等。 rdf：_nnn属性被称为序数属性。</p>
<p>例如，包含Smith的vcards的简单包的模型可能如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">static final String inputFileName = &quot;vc-db-1.rdf&quot;;</span><br><span class="line">   </span><br><span class="line">   public static void main (String args[]) &#123;</span><br><span class="line">       // create an empty model</span><br><span class="line">       Model model = ModelFactory.createDefaultModel();</span><br><span class="line">      </span><br><span class="line">       // use the class loader to find the input file</span><br><span class="line">       InputStream in = FileManager.get().open( inputFileName );</span><br><span class="line">       if (in == null) &#123;</span><br><span class="line">           throw new IllegalArgumentException( &quot;File: &quot; + inputFileName + &quot; not found&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       // read the RDF/XML file</span><br><span class="line">       model.read(new InputStreamReader(in), &quot;&quot;);</span><br><span class="line">       </span><br><span class="line">       // create a bag</span><br><span class="line">       Bag smiths = model.createBag();</span><br><span class="line">       </span><br><span class="line">       // select all the resources with a VCARD.FN property</span><br><span class="line">       // whose value ends with &quot;Smith&quot;</span><br><span class="line">       StmtIterator iter = model.listStatements(</span><br><span class="line">           new </span><br><span class="line">               SimpleSelector(null, VCARD.FN, (RDFNode) null) &#123;</span><br><span class="line">                   @Override</span><br><span class="line">                   public boolean selects(Statement s) &#123;</span><br><span class="line">                           return s.getString().endsWith(&quot;Smith&quot;);</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">       // add the Smith&apos;s to the bag</span><br><span class="line">       while (iter.hasNext()) &#123;</span><br><span class="line">           smiths.add( iter.nextStatement().getSubject());</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">       // print the graph as RDF/XML</span><br><span class="line">       model.write(new PrintWriter(System.out));</span><br><span class="line">       System.out.println();</span><br><span class="line">       </span><br><span class="line">       // print out the members of the bag</span><br><span class="line">       NodeIterator iter2 = smiths.iterator();</span><br><span class="line">       if (iter2.hasNext()) &#123;</span><br><span class="line">           System.out.println(&quot;The bag contains:&quot;);</span><br><span class="line">           while (iter2.hasNext()) &#123;</span><br><span class="line">               System.out.println(&quot;  &quot; +</span><br><span class="line">                   ((Resource) iter2.next())</span><br><span class="line">                                    .getRequiredProperty(VCARD.FN)</span><br><span class="line">                                    .getString());</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           System.out.println(&quot;The bag is empty&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;rdf:RDF</span><br><span class="line">    xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><br><span class="line">    xmlns:vcard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot;&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&quot;http://somewhere/SarahJones/&quot;&gt;</span><br><span class="line">    &lt;vcard:N rdf:parseType=&quot;Resource&quot;&gt;</span><br><span class="line">      &lt;vcard:Given&gt;Sarah&lt;/vcard:Given&gt;</span><br><span class="line">      &lt;vcard:Family&gt;Jones&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;/vcard:N&gt;</span><br><span class="line">    &lt;vcard:FN&gt;Sarah Jones&lt;/vcard:FN&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">  &lt;rdf:Bag&gt;</span><br><span class="line">    &lt;rdf:li&gt;</span><br><span class="line">      &lt;rdf:Description rdf:about=&quot;http://somewhere/RebeccaSmith/&quot;&gt;</span><br><span class="line">        &lt;vcard:N rdf:parseType=&quot;Resource&quot;&gt;</span><br><span class="line">          &lt;vcard:Given&gt;Rebecca&lt;/vcard:Given&gt;</span><br><span class="line">          &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">        &lt;/vcard:N&gt;</span><br><span class="line">        &lt;vcard:FN&gt;Becky Smith&lt;/vcard:FN&gt;</span><br><span class="line">      &lt;/rdf:Description&gt;</span><br><span class="line">    &lt;/rdf:li&gt;</span><br><span class="line">    &lt;rdf:li&gt;</span><br><span class="line">      &lt;rdf:Description rdf:about=&quot;http://somewhere/JohnSmith/&quot;&gt;</span><br><span class="line">        &lt;vcard:N rdf:parseType=&quot;Resource&quot;&gt;</span><br><span class="line">          &lt;vcard:Given&gt;John&lt;/vcard:Given&gt;</span><br><span class="line">          &lt;vcard:Family&gt;Smith&lt;/vcard:Family&gt;</span><br><span class="line">        &lt;/vcard:N&gt;</span><br><span class="line">        &lt;vcard:FN&gt;John Smith&lt;/vcard:FN&gt;</span><br><span class="line">      &lt;/rdf:Description&gt;</span><br><span class="line">    &lt;/rdf:li&gt;</span><br><span class="line">  &lt;/rdf:Bag&gt;</span><br><span class="line">  &lt;rdf:Description rdf:about=&quot;http://somewhere/MattJones/&quot;&gt;</span><br><span class="line">    &lt;vcard:N rdf:parseType=&quot;Resource&quot;&gt;</span><br><span class="line">      &lt;vcard:Given&gt;Matthew&lt;/vcard:Given&gt;</span><br><span class="line">      &lt;vcard:Family&gt;Jones&lt;/vcard:Family&gt;</span><br><span class="line">    &lt;/vcard:N&gt;</span><br><span class="line">    &lt;vcard:FN&gt;Matt Jones&lt;/vcard:FN&gt;</span><br><span class="line">  &lt;/rdf:Description&gt;</span><br><span class="line">&lt;/rdf:RDF&gt;</span><br><span class="line"></span><br><span class="line">The bag contains:</span><br><span class="line">  Becky Smith</span><br><span class="line">  John Smith</span><br></pre></td></tr></table></figure>
<h3 id="词汇表"><a href="#词汇表" class="headerlink" title="词汇表"></a>词汇表</h3><p>空白节点（Blank Node）<br>表示资源，但不指示资源的URI。空白节点表现为一阶逻辑中存在的合格变量。<br>Dublin Core<br>关于Web资源的元数据标准。更多信息可以在Dublin Core网站上找到。<br>文字（Literal）<br>可以是属性值的字符串。<br>对象（Object）<br>三元组的一部分，即语句的值。<br>谓词（Predicate）<br>三元组的属性部分。<br>属性（Property）<br>属性是资源的属性。例如DC.title是一个属性，和RDF.type一样。<br>资源（Resource）<br>一些实体。它可以是诸如网页的web资源，或者它可以是具体的物理事物，例如树或汽车。它可以是一个抽象的想法，如象棋或足球。资源由URI命名。<br>声明（Statement）<br>RDF模型中的弧，通常被解释为事实。<br>主语Subject）<br>作为RDF模型中的弧源的资源<br>三元组（Triple）<br>包含主语，谓词和对象的结构。语句的另一个术语。</p>
<h3 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h3><p>RDF资源的标识符可以包括片段标识符，例如， http：// hostname / rdf / tutorial /＃ch-简介，因此，严格地说，RDF资源由URI引用标识。<br>除了作为一个字符串，字面量还有一个可选的语言编码来表示字符串的语言。例如，文字“two”对于英语可能具有“en”的语言编码，而对于法国，文字“deux”可能具有“fr”的语言编码。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/26/Distributed Cache在mapreduce中读取小文件/" itemprop="url">
                  Distributed Cache在mapreduce中读取小文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-26T22:48:13+08:00" content="2016-11-26">
              2016-11-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/26/Distributed Cache在mapreduce中读取小文件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/26/Distributed Cache在mapreduce中读取小文件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Distributed Cache 在 MapReduce 任务中应用很广， 它可以大大提高一些被频繁读取文件的访问速度。被添加到 Distributed Cache 的文件会被拷贝到 Mapper 和 Reducer 的运行目录中。</p>
<p><strong>在job添加如下方法 </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">remoteReGamePath为hdfs文件路径字符串</span><br><span class="line">job.addCacheFile(new Path(remoteReGamePath).toUri());</span><br></pre></td></tr></table></figure></p>
<p><strong>以下例子为在map中读取此文件并存入集合</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">private Set&lt;String&gt; recommendGame = new HashSet&lt;String&gt;();</span><br><span class="line">/**</span><br><span class="line">		 * 读取推荐游戏文件</span><br><span class="line">		 * </span><br><span class="line">		 * @param uri</span><br><span class="line">		 */</span><br><span class="line">		private void readReGame(URI uri) &#123;</span><br><span class="line">			try &#123;</span><br><span class="line">				Path patternsPath = new Path(uri.getPath());</span><br><span class="line">				String patternsFileName = patternsPath.getName().toString();</span><br><span class="line">				BufferedReader reader = new BufferedReader(new FileReader(</span><br><span class="line">						patternsFileName));</span><br><span class="line">				String line;</span><br><span class="line">				while ((line = reader.readLine()) != null) &#123;</span><br><span class="line">					// TODO: your code here</span><br><span class="line">					//</span><br><span class="line">					recommendGame.add(line.split(&quot;,&quot;)[0]);</span><br><span class="line">				&#125;</span><br><span class="line">				reader.close();</span><br><span class="line"></span><br><span class="line">			&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">				// TODO Auto-generated catch block</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125; catch (IOException e) &#123;</span><br><span class="line">				// TODO Auto-generated catch block</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		protected void setup(</span><br><span class="line">				Mapper&lt;LongWritable, Text, Text, Text&gt;.Context context)</span><br><span class="line">				throws IOException, InterruptedException &#123;</span><br><span class="line">			// TODO Auto-generated method stub</span><br><span class="line">			super.setup(context);</span><br><span class="line">			//获取cache  uri</span><br><span class="line">			URI[] uri = context.getCacheFiles();</span><br><span class="line"></span><br><span class="line">			readReGame(uri[0]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/26/mapreduce多目录输出笔记/" itemprop="url">
                  mapreduce多目录输出笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-26T22:23:21+08:00" content="2016-11-26">
              2016-11-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/26/mapreduce多目录输出笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/26/mapreduce多目录输出笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="使用MultipleOutputs实现多目录-文件输出"><a href="#使用MultipleOutputs实现多目录-文件输出" class="headerlink" title="使用MultipleOutputs实现多目录/文件输出"></a>使用MultipleOutputs实现多目录/文件输出</h3><p><code>org.apache.hadoop.mapreduce.lib.output.MultipleOutputs</code></p>
<p><strong>在map或者reduce类中加入如下方法</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">private MultipleOutputs&lt;Text, NullWritable&gt; mos;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected void setup(Reducer&lt;Text, NullWritable, Text, NullWritable&gt;.Context context)</span><br><span class="line">			throws IOException, InterruptedException &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		super.setup(context);</span><br><span class="line">		mos = new MultipleOutputs&lt;Text, NullWritable&gt;(context);// 初始化mos</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected void cleanup(Reducer&lt;Text, NullWritable, Text, NullWritable&gt;.Context context)</span><br><span class="line">			throws IOException, InterruptedException &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		super.cleanup(context);</span><br><span class="line">		mos.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>在需要输出数据的地方，可以使用定义好的 mos 进行输出</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mos.write(&quot;outputName&quot;, key, value);</span><br><span class="line">mos.write(&quot;outputName&quot;, key, value, &quot;filePrefix&quot;); </span><br><span class="line">mos.write(&quot;outputName&quot;, key, value, &quot;path/filePrefix&quot;);//到文件夹</span><br></pre></td></tr></table></figure></p>
<p><strong>在Job Driver 时定义一些 Named Output</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MultipleOutputs.addNamedOutput(job, &quot;outputXName&quot;,</span><br><span class="line">    XXXOutputFormat.class, OutputXKey.class, OutputXValue.class);</span><br><span class="line">MultipleOutputs.addNamedOutput(job, &quot;outputYName&quot;,</span><br><span class="line">    YYYOutputFormat.class, OutputYKey.class, OutputYValue.class);</span><br></pre></td></tr></table></figure></p>
<p><strong>取消类似part-r-00000的空文件</strong><br><code>LazyOutputFormat.setOutputFormatClass(job, TextOutputFormat.class)</code><br><strong>例子</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">package com.hdu.recommend.mr;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">import org.apache.hadoop.conf.Configuration;</span><br><span class="line">import org.apache.hadoop.fs.Path;</span><br><span class="line">import org.apache.hadoop.io.LongWritable;</span><br><span class="line">import org.apache.hadoop.io.NullWritable;</span><br><span class="line">import org.apache.hadoop.io.Text;</span><br><span class="line">import org.apache.hadoop.mapreduce.Job;</span><br><span class="line">import org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line">import org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.input.TextInputFormat;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.output.LazyOutputFormat;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.output.MultipleOutputs;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.output.NullOutputFormat;</span><br><span class="line">import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;</span><br><span class="line">import org.apache.hadoop.yarn.conf.YarnConfiguration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * @author Skye</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">public class DataCleanIconAndWeb &#123;</span><br><span class="line">	public static class QLMapper extends</span><br><span class="line">			Mapper&lt;LongWritable, Text, Text, NullWritable&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		private String webGame = &quot;网页游戏&quot;;</span><br><span class="line"></span><br><span class="line">		Text outputValue = new Text();</span><br><span class="line">		// 设置多文件输出</span><br><span class="line">		private MultipleOutputs&lt;Text,NullWritable&gt; mos;</span><br><span class="line">		@Override</span><br><span class="line">		protected void setup(Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context context)</span><br><span class="line">				throws IOException, InterruptedException &#123;</span><br><span class="line">			// TODO Auto-generated method stub</span><br><span class="line">			super.setup(context);</span><br><span class="line">			mos = new MultipleOutputs&lt;Text, NullWritable&gt;(context);// 初始化mos</span><br><span class="line">		&#125;</span><br><span class="line">		@Override</span><br><span class="line">		protected void cleanup(Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context context)</span><br><span class="line">				throws IOException, InterruptedException &#123;</span><br><span class="line">			// TODO Auto-generated method stub</span><br><span class="line">			super.cleanup(context);</span><br><span class="line">			mos.close();</span><br><span class="line">		&#125;</span><br><span class="line">		@Override</span><br><span class="line">		protected void map(LongWritable key, Text value, Context context)</span><br><span class="line">				throws IOException, InterruptedException &#123;</span><br><span class="line">			// 接收数据v1</span><br><span class="line">			String line = value.toString();</span><br><span class="line">			// 切分数据</span><br><span class="line">			String[] words = line.split(&quot;&quot;);</span><br><span class="line">			// String[] words = line.split(&quot;\t&quot;);</span><br><span class="line">			boolean isWeb = false;</span><br><span class="line">			boolean flag = true;</span><br><span class="line">			</span><br><span class="line">			//一系列处理代码</span><br><span class="line">			//***</span><br><span class="line">			//***</span><br><span class="line">			//***</span><br><span class="line">			String action = words[1] + &quot;\t&quot; + words[0] + &quot;\t&quot; + words[2]</span><br><span class="line">						+ &quot;\t&quot; + words[3] + &quot;\t&quot; + words[5];</span><br><span class="line"></span><br><span class="line">			outputValue.set(action);</span><br><span class="line">			mos.write(&quot;iconRecord&quot;, outputValue, NullWritable.get(),&quot;iconRecord/icon&quot;);</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">	</span><br><span class="line">			String action = words[1] + &quot;\t&quot; + words[0] + &quot;\t&quot;</span><br><span class="line">							+ words[2] + &quot;\t&quot; + words[3] + &quot;\t&quot; + words[4]</span><br><span class="line">							+ &quot;\t&quot; + words[5];</span><br><span class="line"></span><br><span class="line">			outputValue.set(action);</span><br><span class="line">			mos.write( &quot;webRecord&quot;,outputValue, NullWritable.get(),&quot;webRecord/web&quot;);</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	public static void run(String originalDataPath, String dataCleanOutputFile)</span><br><span class="line">			throws Exception &#123;</span><br><span class="line"></span><br><span class="line">		// 构建Job对象</span><br><span class="line">		Configuration conf = new Configuration();</span><br><span class="line"></span><br><span class="line">		Job job = Job.getInstance(conf);</span><br><span class="line"></span><br><span class="line">		// 注意：main方法所在的类</span><br><span class="line">		job.setJarByClass(DataCleanIconAndWeb.class);</span><br><span class="line">		job.getConfiguration().setBoolean(&quot;mapreduce.output.fileoutputformat.compress&quot;, false);</span><br><span class="line">		job.getConfiguration().setStrings(</span><br><span class="line">				&quot;mapreduce.reduce.shuffle.input.buffer.percent&quot;, &quot;0.1&quot;);</span><br><span class="line">		job.getConfiguration().setBoolean(&quot;mapreduce.output.fileoutputformat.compress&quot;, false);</span><br><span class="line">		job.setNumReduceTasks(3);</span><br><span class="line"></span><br><span class="line">		// 设置Mapper相关属性</span><br><span class="line">		job.setMapperClass(QLMapper.class);</span><br><span class="line">		job.setMapOutputKeyClass(Text.class);</span><br><span class="line">		job.setMapOutputValueClass(NullWritable.class);</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		FileInputFormat.setInputPaths(job, new Path(originalDataPath));</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		// 设置Reducer相关属性</span><br><span class="line">		</span><br><span class="line">		job.setOutputKeyClass(Text.class);</span><br><span class="line">		job.setOutputValueClass(NullWritable.class);</span><br><span class="line"></span><br><span class="line">		FileOutputFormat.setOutputPath(job, new Path(dataCleanOutputFile));</span><br><span class="line">		</span><br><span class="line">		MultipleOutputs.addNamedOutput(job, &quot;iconRecord&quot;,</span><br><span class="line">				TextOutputFormat.class, Text.class, NullWritable.class);</span><br><span class="line">		MultipleOutputs.addNamedOutput(job, &quot;webRecord&quot;,</span><br><span class="line">				TextOutputFormat.class, Text.class, NullWritable.class);</span><br><span class="line">		</span><br><span class="line">		// 文件格式</span><br><span class="line">		job.setInputFormatClass(TextInputFormat.class);</span><br><span class="line">		//取消part-r-00000新式文件输出</span><br><span class="line">		LazyOutputFormat.setOutputFormatClass(job, TextOutputFormat.class);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		//job.setOutputFormatClass(TextOutputFormat.class);</span><br><span class="line">		// 提交任务</span><br><span class="line">		job.waitForCompletion(true);</span><br><span class="line"></span><br><span class="line">		long endTime = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>参考<br><a href="http://gnailuy.com/dataplatform/2015/11/22/common-techniques-for-mapreduce/" target="_blank" rel="external">http://gnailuy.com/dataplatform/2015/11/22/common-techniques-for-mapreduce/</a><br><a href="http://blog.csdn.net/zgc625238677/article/details/51524786" target="_blank" rel="external">http://blog.csdn.net/zgc625238677/article/details/51524786</a><br><a href="https://www.iteblog.com/archives/848" target="_blank" rel="external">https://www.iteblog.com/archives/848</a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/26/hive数据导入/" itemprop="url">
                  hive数据查询导出
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-26T22:17:43+08:00" content="2016-11-26">
              2016-11-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/26/hive数据导入/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/26/hive数据导入/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="hive数据查询导出"><a href="#hive数据查询导出" class="headerlink" title="hive数据查询导出"></a>hive数据查询导出</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite directory &apos;/user/hdu/recommend/gameRecommendNew4/test11.26/gameprestep1&apos;</span><br><span class="line">row format delimited</span><br><span class="line">fields terminated by &apos;\t&apos;</span><br><span class="line">SELECT userid , gamename , COUNT(*) AS count , MAX(gamestarttime) AS lasttime</span><br><span class="line">FROM userdetailtwo</span><br><span class="line">GROUP BY userid , gamename</span><br></pre></td></tr></table></figure>
<p><strong>出错</strong><br><code>FAILED: ParseException line 2:0 cannot recognize input near &#39;row&#39; &#39;format&#39; &#39;delimited&#39; in statement</code></p>
<p><strong>原因</strong><br>This is because the hive query will by default use the ^ as the delimiter. You can try the same by exporting to local file system.That should be supported.</p>
<p><strong>解决</strong><br>create an external table to the location where you want your output file.Use create table as command and insert the required data into the external table.By that you will get the data in the HDFS location<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create external table user_game_count_lasttime2(userid STRING ,gamename STRING,count INT,lasttime STRING)</span><br><span class="line">ROW FORMAT DELIMITED</span><br><span class="line">FIElDS TERMINATED BY &apos;\t&apos;</span><br><span class="line">STORED AS TEXTFILE</span><br><span class="line">LOCATION &apos;/user/hdu/recommend/gameRecommendNew4/test11.26/gameprestep1_2&apos;;</span><br><span class="line"></span><br><span class="line">insert overwrite table user_game_count_lasttime2 </span><br><span class="line">SELECT userid , gamename , COUNT(*) AS count , MAX(gamestarttime) AS lasttime</span><br><span class="line">FROM userdetailtwo</span><br><span class="line">GROUP BY userid , gamename;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/05/hadoop Job命令/" itemprop="url">
                  Hadoop Job相关命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-05T10:54:40+08:00" content="2016-11-05">
              2016-11-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/05/hadoop Job命令/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/05/hadoop Job命令/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>hadoop命令行 与job相关的：<br>命令行工具 •<br>1.查看 Job 信息：<br>hadoop job -list<br>2.杀掉 Job：<br>hadoop  job -kill  job_id<br>3.指定路径下查看历史日志汇总：<br>hadoop job -history output-dir<br>4.作业的更多细节：<br>hadoop job -history all output-dir<br>5.打印map和reduce完成百分比和所有计数器：<br>hadoop job -status job_id<br>6.杀死任务。被杀死的任务不会不利于失败尝试：<br>hadoop jab -kill-task <task-id><br>7.使任务失败。被失败的任务会对失败尝试不利：<br>hadoop job  -fail-task <task-id></task-id></task-id></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/03/mapreduce运行内存及JVM配置错误running beyond physical /" itemprop="url">
                  mapreduce运行内存及JVM配置错误running beyond physical memory limits
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-03T20:09:27+08:00" content="2016-11-03">
              2016-11-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/03/mapreduce运行内存及JVM配置错误running beyond physical /#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/03/mapreduce运行内存及JVM配置错误running beyond physical /" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="错误描述："><a href="#错误描述：" class="headerlink" title="错误描述："></a>错误描述：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">16/11/02 21:52:58 INFO mapreduce.Job: Task Id : attempt_1476760655616_0575_r_000000_2, Status : FAILED</span><br><span class="line">Container [pid=24537,containerID=container_1476760655616_0575_01_000052] is running beyond physical memory limits. Current usage: 4.0 GB of 3 GB physical memory used; 6.9 GB of 6.3 GB virtual memory used. Killing container.</span><br><span class="line">Dump of the process-tree for container_1476760655616_0575_01_000052 :</span><br><span class="line">	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE</span><br></pre></td></tr></table></figure>
<h3 id="解决："><a href="#解决：" class="headerlink" title="解决："></a>解决：</h3><p>查看hadoop配置参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;mapreduce.map.memory.mb&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;3072&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">      &lt;name&gt;mapreduce.reduce.memory.mb&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;3072&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">          &lt;name&gt;mapreduce.map.java.opts&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;-Xmx3072m&lt;/value&gt;</span><br><span class="line">            &lt;/property&gt;</span><br><span class="line">            &lt;property&gt;</span><br><span class="line">              &lt;name&gt;mapreduce.reduce.java.opts&lt;/name&gt;</span><br><span class="line">                &lt;value&gt;-Xmx6144m&lt;/value&gt;</span><br><span class="line">                &lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>mapreduce.reduce.java.opts</code>参数大于<code>mapreduce.reduce.memory.mb</code>,需小于才行</p>
<p>在mapreduce执行函数中设置参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conf.setInt(&quot;mapreduce.reduce.memory.mb&quot;, 6144);</span><br></pre></td></tr></table></figure></p>
<p>1.</p>
<p>参考 </p>
<blockquote>
<p><a href="http://stackoverflow.com/questions/21005643/container-is-running-beyond-memory-limits" target="_blank" rel="external">http://stackoverflow.com/questions/21005643/container-is-running-beyond-memory-limits</a></p>
</blockquote>
<p>我们集群中的每台机器都有48 GB的RAM。此RAM的一些应保留为操作系统使用。在每个节点上，我们将为YARN分配40 GB RAM以使用操作系统并保留8 GB</p>
<p>对于我们的示例集群，我们有一个容器的最小RAM（yarn.scheduler.minimum-allocation-mb）= 2 GB。因此，我们将为Map任务容器分配4 GB，为Reduce任务容器分配8 GB。</p>
<p>在mapred-site.xml中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mapreduce.map.memory.mb：4096</span><br><span class="line"></span><br><span class="line">mapreduce.reduce.memory.mb：8192</span><br></pre></td></tr></table></figure></p>
<p>每个容器将运行Map和Reduce任务的JVM。 JVM堆大小应设置为低于上面定义的Map和Reduce内存，以使它们在YARN分配的Container内存的边界内。</p>
<p>在mapred-site.xml中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mapreduce.map.java.opts：-Xmx3072m</span><br><span class="line"></span><br><span class="line">mapreduce.reduce.java.opts：-Xmx6144m</span><br></pre></td></tr></table></figure></p>
<p>以上设置配置Map和Reduce任务将使用的物理RAM的上限。<br>。</p>
<p>2.</p>
<blockquote>
<p><a href="http://blog.chinaunix.net/uid-25691489-id-5587957.html" target="_blank" rel="external">http://blog.chinaunix.net/uid-25691489-id-5587957.html</a></p>
</blockquote>
<p>大概是job运行超过了map和reduce设置的内存大小，导致任务失败，调整增加了map和reduce的内容，问题排除，一些参数介绍如下：</p>
<p>RM的内存资源配置，主要是通过下面的两个参数进行的（这两个值是Yarn平台特性，应在yarn-site.xml中配置好）：<br>yarn.scheduler.minimum-allocation-mb<br>yarn.scheduler.maximum-allocation-mb<br>说明：单个容器可申请的最小与最大内存，应用在运行申请内存时不能超过最大值，小于最小值则分配最小值，从这个角度看，最小值有点想操作系统中的页。最小值还有另外一种用途，计算一个节点的最大container数目注：这两个值一经设定不能动态改变(此处所说的动态改变是指应用运行时)。</p>
<p>NM的内存资源配置，主要是通过下面两个参数进行的（这两个值是Yarn平台特性，应在yarn-sit.xml中配置） ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn.nodemanager.resource.memory-mb</span><br><span class="line">yarn.nodemanager.vmem-pmem-ratio</span><br></pre></td></tr></table></figure></p>
<p>说明：每个节点可用的最大内存，RM中的两个值不应该超过此值。此数值可以用于计算container最大数目，即：用此值除以RM中的最小容器内存。虚拟内存率，是占task所用内存的百分比，默认值为2.1倍;注意：第一个参数是不可修改的，一旦设置，整个运行过程中不可动态修改，且该值的默认大小是8G，即使计算机内存不足8G也会按着8G内存来使用。</p>
<p>AM内存配置相关参数，此处以MapReduce为例进行说明（这两个值是AM特性，应在mapred-site.xml中配置），如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapreduce.map.memory.mb</span><br><span class="line">mapreduce.reduce.memory.mb</span><br></pre></td></tr></table></figure></p>
<p>说明：这两个参数指定用于MapReduce的两个任务（Map and Reduce task）的内存大小，其值应该在RM中的最大最小container之间。如果没有配置则通过如下简单公式获得：<br>max(MIN_CONTAINER_SIZE, (Total Available RAM) / containers))<br>一般的reduce应该是map的2倍。注：这两个值可以在应用启动时通过参数改变；</p>
<p>AM中其它与内存相关的参数，还有JVM相关的参数，这些参数可以通过，如下选项配置：<br>mapreduce.map.java.opts<br>mapreduce.reduce.java.opts<br>说明：这两个参主要是为需要运行JVM程序（java、scala等）准备的，通过这两个设置可以向JVM中传递参数的，与内存有关的是，-Xmx，-Xms等选项。此数值大小，应该在AM中的map.mb和reduce.mb之间。</p>
<p>我们对上面的内容进行下总结，当配置Yarn内存的时候主要是配置如下三个方面：每个Map和Reduce可用物理内存限制；对于每个任务的JVM对大小的限制；虚拟内存的限制；</p>
<p>下面通过一个具体错误实例，进行内存相关说明，错误如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Container[pid=41884,containerID=container_1405950053048_0016_01_000284] is running beyond virtual memory limits. Current usage: 314.6 MB of 2.9 GB physical memory used; 8.7 GB of 6.2 GB virtual memory used. Killing container.</span><br></pre></td></tr></table></figure></p>
<p>配置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">            &lt;name&gt;yarn.nodemanager.resource.memory-mb&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;100000&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">            &lt;name&gt;yarn.scheduler.maximum-allocation-mb&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;10000&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">            &lt;name&gt;yarn.scheduler.minimum-allocation-mb&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;3000&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">       &lt;property&gt;</span><br><span class="line">            &lt;name&gt;mapreduce.reduce.memory.mb&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;2000&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br></pre></td></tr></table></figure></p>
<p>通过配置我们看到，容器的最小内存和最大内存分别为：3000m和10000m，而reduce设置的默认值小于2000m，map没有设置，所以两个值均为3000m，也就是log中的“2.9 GB physical<br>memory used”。而由于使用了默认虚拟内存率(也就是2.1倍)，所以对于Map Task和Reduce Task总的虚拟内存为都为3000*2.1=6.2G。而应用的虚拟内存超过了这个数值，故报错 。解决办<br>法：在启动Yarn是调节虚拟内存率或者应用运行时调节内存大小。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/03/mapreduce执行错误Mapper.init错误/" itemprop="url">
                  mapreduce执行错误Mapper.<init>错误
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-03T20:07:23+08:00" content="2016-11-03">
              2016-11-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/03/mapreduce执行错误Mapper.init错误/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/03/mapreduce执行错误Mapper.init错误/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>参考<br><a href="http://blog.itpub.net/30066956/viewspace-2107549/" target="_blank" rel="external">http://blog.itpub.net/30066956/viewspace-2107549/</a></p>
</blockquote>
<p>错误详情：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">16/11/02 21:37:26 INFO mapreduce.Job: Task Id : attempt_1476760655616_0574_m_000027_2, Status : FAILED</span><br><span class="line">Error: java.lang.RuntimeException: java.lang.NoSuchMethodException: com.hdu.recommend.tools.CopyData$QLMapper.&lt;init&gt;()</span><br><span class="line">	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:131)</span><br><span class="line">	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:742)</span><br><span class="line">	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:341)</span><br><span class="line">	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:168)</span><br><span class="line">	at java.security.AccessController.doPrivileged(Native Method)</span><br><span class="line">	at javax.security.auth.Subject.doAs(Subject.java:415)</span><br><span class="line">	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1614)</span><br><span class="line">	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:163)</span><br><span class="line">Caused by: java.lang.NoSuchMethodException: com.hdu.recommend.tools.CopyData$QLMapper.&lt;init&gt;()</span><br><span class="line">	at java.lang.Class.getConstructor0(Class.java:2849)</span><br><span class="line">	at java.lang.Class.getDeclaredConstructor(Class.java:2053)</span><br><span class="line">	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:125)</span><br><span class="line">	... 7 more</span><br></pre></td></tr></table></figure></p>
<p>解决：<br>注意Mapper 与 Reducer 类写成内部类，一定要加static ！！！！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/" itemprop="url">
                  eclipse中操作hive错误org.apache.hadoop.security.AccessControlException
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-03T19:27:08+08:00" content="2016-11-03">
              2016-11-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/大数据/" itemprop="url" rel="index">
                    <span itemprop="name">大数据</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/03/eclipse中操作hive错误org.apache.hadoop.security.AccessControlException/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java.sql.SQLException: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask</span><br><span class="line"></span><br><span class="line">Job Submission failed with exception &apos;org.apache.hadoop.security.AccessControlException(Permission denied: user=anonymous, access=WRITE, inode=&quot;/user&quot;:hdfs:supergroup:drwxr-xr-x</span><br></pre></td></tr></table></figure></p>
<p>解决：<br>权限问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -chmod -R 777  /</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/28/Git SSH公钥配置/" itemprop="url">
                  Git SSH公钥配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-28T16:28:47+08:00" content="2016-10-28">
              2016-10-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/28/Git SSH公钥配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/28/Git SSH公钥配置/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Coding.net配置</p>
</blockquote>
<h3 id="账户-SSH-公钥"><a href="#账户-SSH-公钥" class="headerlink" title="账户 SSH 公钥"></a>账户 SSH 公钥</h3><p>账户 SSH 公钥是跟用户账户关联的公钥，一旦设置，SSH 就拥有账户下所有项目仓库的读写权限。 设置“账户 SSH 公钥”是开发者使用 SSH 方式访问/修改代码仓库的“前置工作”，分为“获取 SSH 协议地址”、“生成公钥”、“在 Coding.net 添加公钥”三个步骤。</p>
<h3 id="获取-SSH-协议地址"><a href="#获取-SSH-协议地址" class="headerlink" title="获取 SSH 协议地址"></a>获取 SSH 协议地址</h3><p>在项目的代码页面点击 SSH 切换到 SSH 协议， 获得 clone 地址，形如<code>git@git.coding.net:wzw/leave-a-message.git</code>。 请使用这个地址来访问您的代码仓库。</p>
<h3 id="生成公钥"><a href="#生成公钥" class="headerlink" title="生成公钥"></a>生成公钥</h3><p>Mac/Linux 打开命令行终端, Windows 打开 Git Bash 。 输入<code>ssh-keygen -t rsa -C &quot;username@example.com&quot;</code>,( 注册的邮箱)，接下来点击enter键即可（也可以输入密码）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</span><br><span class="line"># Creates a new ssh key, using the provided email as a label</span><br><span class="line"># Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]  // 推荐使用默认地址,如果使用非默认地址可能需要配置 .ssh/config</span><br><span class="line">成功之后</span><br><span class="line"></span><br><span class="line">Your identification has been saved in /Users/you/.ssh/id_rsa.</span><br><span class="line"># Your public key has been saved in /Users/you/.ssh/id_rsa.pub.</span><br><span class="line"># The key fingerprint is:</span><br><span class="line"># 01:0f:f4:3b:ca:85:d6:17:a1:7d:f0:68:9d:f0:a2:db your_email@example.com</span><br></pre></td></tr></table></figure></p>
<h3 id="在-Coding-net-添加公钥"><a href="#在-Coding-net-添加公钥" class="headerlink" title="在 Coding.net 添加公钥"></a>在 Coding.net 添加公钥</h3><p>本地打开 id_rsa.pub 文件（或执行 $cat id_rsa.pub ），复制其中全部内容，添加到账户“SSH 公钥”页面 中，公钥名称可以随意起名字。<br>完成后点击“添加”，然后输入密码或动态码即可添加完成。</p>
<h3 id="完成后在命令行测试，首次建立链接会要求信任主机"><a href="#完成后在命令行测试，首次建立链接会要求信任主机" class="headerlink" title="完成后在命令行测试，首次建立链接会要求信任主机"></a>完成后在命令行测试，首次建立链接会要求信任主机</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@git.coding.net // 注意 git.coding.net 接入到 CDN 上所以会解析多个不同的 host ip The authenticity of host ‘git.coding.net (61.146.73.68)’ can not be established. RSA key fingerprint is 98:ab:2b:30:60:00:82:86:bb:85:db:87:22:c4:4f:b1. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added ‘git.coding.net,61.146.73.68’ (RSA) to the list of kn own hosts.</span><br><span class="line"></span><br><span class="line">Enter passphrase for key ‘/c/Users/Yuankai/.ssh/id_rsa’: Coding.net Tips : [ Hello Kyle_lyk! You have connected to Coding.net by SSH successfully! ]</span><br></pre></td></tr></table></figure>
<p>接下来就可以用git操作仓库了，是使用SourceTree非常方便</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="Skye" />
          <p class="site-author-name" itemprop="name">Skye</p>
          <p class="site-description motion-element" itemprop="description">学习总结 思想感悟</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">36</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/1811544100" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/Skyexu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Skye</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"skyexu"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  






  
  
  

  

  

</body>
</html>
